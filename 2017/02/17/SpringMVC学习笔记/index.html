<!doctype html>



  


<html class="theme-next pisces use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>



<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />












  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />




  
  
  
  

  
    
    
  

  

  

  

  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Lato:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.0" rel="stylesheet" type="text/css" />


  <meta name="keywords" content="技术总结,SpringMVC," />








  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=5.1.0" />






<meta name="description" content="一、SpringMVC介绍1.SpringMVC框架：
2.SpringMVC架构：2.1  架构图：
2.2 架构说明：
1.用户发送请求至前端控制器DispatchServlet
2.DispatchServlet收到请求调用处理器映射器HandlerMapping
3.处理器映射器根据请求url找到具体的处理器，生成处理器对象及处理器拦截器(如果有则生成)一并返回给DispatcherSer">
<meta property="og:type" content="article">
<meta property="og:title" content="SpringMVC学习笔记">
<meta property="og:url" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/index.html">
<meta property="og:site_name" content="Timer`s blog">
<meta property="og:description" content="一、SpringMVC介绍1.SpringMVC框架：
2.SpringMVC架构：2.1  架构图：
2.2 架构说明：
1.用户发送请求至前端控制器DispatchServlet
2.DispatchServlet收到请求调用处理器映射器HandlerMapping
3.处理器映射器根据请求url找到具体的处理器，生成处理器对象及处理器拦截器(如果有则生成)一并返回给DispatcherSer">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1_2.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1_3_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1_3_2.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1_4_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1_4_2.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/2_3_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/2_5_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/3_2_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/Users/chenping/Documents/blog/qjbagugit.github.io/source/_posts/SpringMVC学习笔记/6_7_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/11_2_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/13_1_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/14_2_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/15_2_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/15_3_1.png">
<meta property="og:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/15_4_1.png">
<meta property="og:updated_time" content="2017-02-25T11:22:15.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SpringMVC学习笔记">
<meta name="twitter:description" content="一、SpringMVC介绍1.SpringMVC框架：
2.SpringMVC架构：2.1  架构图：
2.2 架构说明：
1.用户发送请求至前端控制器DispatchServlet
2.DispatchServlet收到请求调用处理器映射器HandlerMapping
3.处理器映射器根据请求url找到具体的处理器，生成处理器对象及处理器拦截器(如果有则生成)一并返回给DispatcherSer">
<meta name="twitter:image" content="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/1.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    sidebar: {"position":"right","display":"post"},
    fancybox: true,
    motion: true,
    duoshuo: {
      userId: '0',
      author: '作者'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/"/>





  <title> SpringMVC学习笔记 | Timer`s blog </title>
</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  










  
  
    
  

  <div class="container one-collumn sidebar-position-right page-post-detail ">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-meta ">
  

  <div class="custom-logo-site-title">
    <a href="/"  class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <span class="site-title">Timer`s blog</span>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>
  <p class="site-subtitle"></p>
</div>

<div class="site-nav-toggle">
  <button>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
    <span class="btn-bar"></span>
  </button>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal " itemscope itemtype="http://schema.org/Article">
  <link itemprop="mainEntityOfPage" href="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/">

  <span style="display:none" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="name" content="Timer">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="/images/avatar.gif">
  </span>

  <span style="display:none" itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="Timer`s blog">
    <span style="display:none" itemprop="logo" itemscope itemtype="http://schema.org/ImageObject">
      <img style="display:none;" itemprop="url image" alt="Timer`s blog" src="">
    </span>
  </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
            
            
              
                SpringMVC学习笔记
              
            
          </h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2017-02-17T09:18:51+08:00">
                2017-02-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
              <span class="post-meta-divider">|</span>
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术总结/" itemprop="url" rel="index">
                    <span itemprop="name">技术总结</span>
                  </a>
                </span>

                
                
                  ， 
                
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/技术总结/SpringMVC/" itemprop="url" rel="index">
                    <span itemprop="name">SpringMVC</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <a href="/2017/02/17/SpringMVC学习笔记/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count ds-thread-count" data-thread-key="2017/02/17/SpringMVC学习笔记/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          

          
          
             <span id="/2017/02/17/SpringMVC学习笔记/" class="leancloud_visitors" data-flag-title="SpringMVC学习笔记">
               <span class="post-meta-divider">|</span>
               <span class="post-meta-item-icon">
                 <i class="fa fa-eye"></i>
               </span>
               <span class="post-meta-item-text">阅读次数 </span>
               <span class="leancloud-visitors-count"></span>
              </span>
          

          

          

        </div>
      </header>
    


    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="一、SpringMVC介绍"><a href="#一、SpringMVC介绍" class="headerlink" title="一、SpringMVC介绍"></a>一、SpringMVC介绍</h1><h2 id="1-SpringMVC框架："><a href="#1-SpringMVC框架：" class="headerlink" title="1.SpringMVC框架："></a>1.SpringMVC框架：</h2><p><img src="/2017/02/17/SpringMVC学习笔记/1.png" width="800" height="500/"></p>
<h2 id="2-SpringMVC架构："><a href="#2-SpringMVC架构：" class="headerlink" title="2.SpringMVC架构："></a>2.SpringMVC架构：</h2><h3 id="2-1-架构图："><a href="#2-1-架构图：" class="headerlink" title="2.1  架构图："></a>2.1  架构图：</h3><p><img src="/2017/02/17/SpringMVC学习笔记/1_2.png" width="800" height="500/"></p>
<h3 id="2-2-架构说明："><a href="#2-2-架构说明：" class="headerlink" title="2.2 架构说明："></a>2.2 架构说明：</h3><ul>
<li>1.用户发送请求至前端控制器<code>DispatchServlet</code></li>
<li>2.<code>DispatchServlet</code>收到请求调用处理器映射器<code>HandlerMapping</code></li>
<li>3.处理器映射器根据请求url找到具体的处理器，生成处理器对象及处理器拦截器(如果有则生成)一并返回给<code>DispatcherServlet</code>。</li>
<li>4.<code>DispatcherServlet</code>通过<code>HandlerAdapter</code>处理器适配器调用处理器</li>
<li>5.执行处理器(Controller，也叫后端控制器)</li>
<li>6.Controller执行完成返回<code>ModelAndView</code></li>
<li>7.<code>HandlerAdapter</code>将controller执行结果<code>ModelAndView</code>返回给<code>DispatcherServlet</code></li>
<li>8.<code>DispatcherServlet</code>将<code>ModelAndView</code>传给<code>ViewReslover</code>视图解析器</li>
<li>9.<code>ViewReslover</code>解析后返回具体View</li>
<li>10.<code>DispatcherServlet</code>对View进行渲染视图(即将模型数据填充至视图中)</li>
<li>11.<code>DispatcherServlet</code>响应用户</li>
</ul>
<h3 id="2-3-组件说明："><a href="#2-3-组件说明：" class="headerlink" title="2.3 组件说明："></a>2.3 组件说明：</h3><p>​    以下组件通常使用框架提供的实现：</p>
<ul>
<li><p>DispatcherServlet：前端控制器</p>
<p>用户请求到达前端控制器，它就相当于mvc模式中的c，dispatcherServlet是整个流程控制的中心，由它调用其它组件处理用户的请求，dispatcherServlet的存在降低了组件之间的耦合性。</p>
</li>
<li><p>HandlerMapping：处理器映射器</p>
<p>HandlerMapping负责根据用户请求找到Handler即处理器，springmvc提供了不同的映射器实现不同的映射方式，例如：配置文件方式，实现接口方式，注解方式等。</p>
</li>
<li><p>Handler：处理器</p>
<p>Handler是继DispatcherServlet前端控制器的后端控制器，在DispatcherServlet的控制下Handler对具体的用户请求进行处理。</p>
<p><strong>==由于Handler涉及到具体的用户业务请求，所以一般情况需要程序员根据业务需求开发Handler==</strong></p>
</li>
<li><p>HandlAdapter：处理器适配器</p>
<p>通过HandlerAdapter对处理器进行执行，这是适配器模式的应用，通过扩展适配器可以对更多类型的处理器进行执行</p>
</li>
<li><p>View Resolver：视图解析器</p>
<p><a href="undefined">View Resolver</a>负责将处理结果生成View视图，View Resolver首先根据逻辑视图名解析成物理视图名即具体的页面地址，再生成View视图对象，最后对View进行渲染将处理结果通过页面展示给用户。 springmvc框架提供了很多的View视图类型，包括：jstlView、freemarkerView、pdfView等</p>
<p><strong>==一般情况下需要通过页面标签或页面模版技术将模型数据通过页面展示给用户，需要由程序员根据业务需求开发具体的页面==</strong></p>
<p>​</p>
</li>
</ul>
<h1 id="二、入门程序"><a href="#二、入门程序" class="headerlink" title="二、入门程序"></a>二、入门程序</h1><h2 id="1-项目介绍："><a href="#1-项目介绍：" class="headerlink" title="1.项目介绍："></a>1.项目介绍：</h2><h3 id="1-1-需求：-实现商品查询列表功能"><a href="#1-1-需求：-实现商品查询列表功能" class="headerlink" title="1.1 需求：==实现商品查询列表功能=="></a>1.1 需求：==实现商品查询列表功能==</h3><ul>
<li><a href="/downloads/code/SpringMVC学习笔记/sql.zip">数据库表：</a></li>
</ul>
<p><img src="/2017/02/17/SpringMVC学习笔记/1_1.png" width="200" height="500/"></p>
<ul>
<li><a href="/downloads/code/SpringMVC学习笔记/SpringMVCProduct.zip">最终代码</a></li>
</ul>
<h3 id="1-2-开发环境装备：Eclipse-tomcat"><a href="#1-2-开发环境装备：Eclipse-tomcat" class="headerlink" title="1.2 开发环境装备：Eclipse+tomcat"></a>1.2 开发环境装备：Eclipse+tomcat</h3><h3 id="1-3-建立一个WEB项目"><a href="#1-3-建立一个WEB项目" class="headerlink" title="1.3 建立一个WEB项目"></a>1.3 建立一个WEB项目</h3><ul>
<li><p>为了让在Eclipse中建立的项目能够在MyEclipse中也可以导入，做以下修改：</p>
<p><img src="/2017/02/17/SpringMVC学习笔记/1_3_1.png" width="500" height="500/"></p>
<p>​</p>
</li>
<li><p><img src="/2017/02/17/SpringMVC学习笔记/1_3_2.png" width="500" height="500/"></p>
</li>
</ul>
<h3 id="1-4-导入相关jar包："><a href="#1-4-导入相关jar包：" class="headerlink" title="1.4 导入相关jar包："></a>1.4 导入相关jar包：</h3><ul>
<li><p>需要导入的包(项目最终所有的jar包)：</p>
<p><img src="/2017/02/17/SpringMVC学习笔记/1_4_1.png" width="300" height="500/"></p>
</li>
</ul>
<p><img src="/2017/02/17/SpringMVC学习笔记/1_4_2.png" width="300" height="500/"></p>
<h2 id="2-配置前端控制器"><a href="#2-配置前端控制器" class="headerlink" title="2.配置前端控制器"></a>2.配置前端控制器</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">display-name</span>&gt;</span>SpringMVCProduct<span class="tag">&lt;/<span class="name">display-name</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- springmvc前端控制器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">	contextConfigLocation配置springmvc加载的配置文件，配置处理器映射器、适配器等等</div><div class="line">	如果不配置，默认加载/WEB-INF/servlet名称-servlet.xml(SpringMVCProduct-servlet.xml)</div><div class="line">	 --&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- </span></div><div class="line">		1、*.action: 访问.action结尾的DispatcherServlet进行解析</div><div class="line">		2、/ 所有访问的地址都由DispatcherServlet进行解析，对于静态文件的解析需要配置不让DispatcherServlet进行解析，使用此方式可以实现RESTful风格的url</div><div class="line">		3、/* 这种配置不对,使用这种配置，最终转发到一个jsp页面时，仍然会由DispatcherServlet解析jsp，不能根据jsp页面来找到Handler，会报错。</div><div class="line">	 --&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>*.action<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="3-配置处理器适配器"><a href="#3-配置处理器适配器" class="headerlink" title="3.配置处理器适配器"></a>3.配置处理器适配器</h2><h3 id="3-1-在springmvc-xml中进行如下配置："><a href="#3-1-在springmvc-xml中进行如下配置：" class="headerlink" title="3.1 在springmvc.xml中进行如下配置："></a>3.1 在springmvc.xml中进行如下配置：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 处理器适配器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.SimpleControllerHandlerAdapter"</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="3-2-编写Handler-Controller-："><a href="#3-2-编写Handler-Controller-：" class="headerlink" title="3.2 编写Handler(Controller)："></a>3.2 编写Handler(Controller)：</h3><ul>
<li><p>因为处理器适配器使用的是<code>SimpleControllerHandlerAdapter</code>，所以Handler必须实现Controller接口。</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsController1</span> <span class="keyword">implements</span> <span class="title">Controller</span></span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">handleRequest</span><span class="params">(HttpServletRequest arg0, HttpServletResponse arg1)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="comment">// 创建静态数据</span></div><div class="line">		List&lt;Items&gt; itemsList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">		Items item1 = <span class="keyword">new</span> Items();</div><div class="line">		item1.setName(<span class="string">"联想笔记本"</span>);</div><div class="line">		item1.setPrice(<span class="number">6000f</span>);</div><div class="line">		item1.setDetail(<span class="string">"ThinkPad T430 联想笔记本电脑"</span>);</div><div class="line">		Items item2 = <span class="keyword">new</span> Items();</div><div class="line">		item2.setName(<span class="string">"苹果手机"</span>);</div><div class="line">		item2.setPrice(<span class="number">5000f</span>);</div><div class="line">		item2.setDetail(<span class="string">"IPhone6 64G 黑色"</span>);</div><div class="line">		itemsList.add(item1);</div><div class="line">		itemsList.add(item2);</div><div class="line">		<span class="comment">// 返回ModelAndView</span></div><div class="line">		ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</div><div class="line">		<span class="comment">// 相当于request的setAttribute方法</span></div><div class="line">		modelAndView.addObject(<span class="string">"itemsList"</span>,itemsList);</div><div class="line">		<span class="comment">// 指定视图</span></div><div class="line">		modelAndView.setViewName(<span class="string">"/WEB-INF/jsp/items/itemsList.jsp"</span>);</div><div class="line">		<span class="keyword">return</span> modelAndView;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>视图编写：</p>
<p><a href="/downloads/code/SpringMVC学习笔记/1_itemsList.jsp">itemsList.jsp</a></p>
<p><img src="/2017/02/17/SpringMVC学习笔记/2_3_1.png" width="300" height="500/"></p>
</li>
</ul>
<h2 id="4-配置处理器映射器"><a href="#4-配置处理器映射器" class="headerlink" title="4.配置处理器映射器"></a>4.配置处理器映射器</h2><h3 id="4-1-在springmvc-xml中进行如下配置："><a href="#4-1-在springmvc-xml中进行如下配置：" class="headerlink" title="4.1 在springmvc.xml中进行如下配置："></a>4.1 在springmvc.xml中进行如下配置：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 处理器映射器 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 将bean的name作为url进行查找，需要在配置Handler时指定beanname(就是url) --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="4-2-配置Handler："><a href="#4-2-配置Handler：" class="headerlink" title="4.2 配置Handler："></a>4.2 配置Handler：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 配置Handler --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">name</span>=<span class="string">"/queryItems.action"</span> <span class="attr">class</span>=<span class="string">"com.ssm.controller.ItemsController1"</span>/&gt;</span></div></pre></td></tr></table></figure>
<h2 id="5-配置视图解析器"><a href="#5-配置视图解析器" class="headerlink" title="5.配置视图解析器"></a>5.配置视图解析器</h2><h3 id="5-1-在springmvc-xml中进行如下配置："><a href="#5-1-在springmvc-xml中进行如下配置：" class="headerlink" title="5.1 在springmvc.xml中进行如下配置："></a>5.1 在springmvc.xml中进行如下配置：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 视图解析器 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- jsp视图解析器,默认使用jstl标签，classpath下需要有jstl的包 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span> /&gt;</span></div></pre></td></tr></table></figure>
<h3 id="5-2-访问Url："><a href="#5-2-访问Url：" class="headerlink" title="5.2 访问Url："></a>5.2 访问Url：</h3><p><code>http://localhost:8088/SpringMVCProduct/queryItems.action</code></p>
<p><img src="/2017/02/17/SpringMVC学习笔记/2_5_1.png" width="800" height="500/"></p>
<h1 id="三、非注解的处理器映射器和适配器"><a href="#三、非注解的处理器映射器和适配器" class="headerlink" title="三、非注解的处理器映射器和适配器"></a>三、非注解的处理器映射器和适配器</h1><h2 id="1-映射器"><a href="#1-映射器" class="headerlink" title="1.映射器"></a>1.映射器</h2><h3 id="1-1-BeanNameUrlHandlerMapping"><a href="#1-1-BeanNameUrlHandlerMapping" class="headerlink" title="1.1 BeanNameUrlHandlerMapping"></a>1.1 BeanNameUrlHandlerMapping</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 将bean的name作为url进行查找，需要在配置Handler时指定beanname(就是url) --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"itemsController1"</span> <span class="attr">name</span>=<span class="string">"/queryItems.action"</span> <span class="attr">class</span>=<span class="string">"com.ssm.controller.ItemsController1"</span>/&gt;</span></div></pre></td></tr></table></figure>
<h3 id="1-2-SimpleUrlHandlerMapping"><a href="#1-2-SimpleUrlHandlerMapping" class="headerlink" title="1.2 SimpleUrlHandlerMapping"></a>1.2 SimpleUrlHandlerMapping</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"itemsController1"</span> <span class="attr">class</span>=<span class="string">"com.ssm.controller.ItemsController1"</span>/&gt;</span></div><div class="line"><span class="comment">&lt;!-- 简单url映射 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.SimpleUrlHandlerMapping"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"mappings"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">props</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/queryItems1.action"</span>&gt;</span>itemsController1<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">prop</span> <span class="attr">key</span>=<span class="string">"/queryItems2.action"</span>&gt;</span>itemsController1<span class="tag">&lt;/<span class="name">prop</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">props</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
<p>==多个映射器可以共存==</p>
<h2 id="2-适配器"><a href="#2-适配器" class="headerlink" title="2.适配器"></a>2.适配器</h2><h3 id="2-1-SimpleControllerHandlerAdapter"><a href="#2-1-SimpleControllerHandlerAdapter" class="headerlink" title="2.1 SimpleControllerHandlerAdapter"></a>2.1 SimpleControllerHandlerAdapter</h3><ul>
<li>要求编写的Handler实现Controller接口(<code>前面已经示例</code>)</li>
</ul>
<h3 id="2-2-HttpRequestHandlerAdapter"><a href="#2-2-HttpRequestHandlerAdapter" class="headerlink" title="2.2 HttpRequestHandlerAdapter"></a>2.2 HttpRequestHandlerAdapter</h3><ul>
<li><p>配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"itemsController2"</span> <span class="attr">class</span>=<span class="string">"com.ssm.controller.ItemsController2"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.HttpRequestHandlerAdapter"</span>/&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>要求编写的Handler实现HttpRequestHandler接口</p>
</li>
<li><p>具体实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsController2</span> <span class="keyword">implements</span> <span class="title">HttpRequestHandler</span></span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">handleRequest</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> ServletException, IOException </span>&#123;</div><div class="line">		<span class="comment">// 创建静态数据</span></div><div class="line">		List&lt;Items&gt; itemsList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">		Items item1 = <span class="keyword">new</span> Items();</div><div class="line">		item1.setName(<span class="string">"联想笔记本"</span>);</div><div class="line">		item1.setPrice(<span class="number">6000f</span>);</div><div class="line">		item1.setDetail(<span class="string">"ThinkPad T430 联想笔记本电脑"</span>);</div><div class="line">		Items item2 = <span class="keyword">new</span> Items();</div><div class="line">		item2.setName(<span class="string">"苹果手机"</span>);</div><div class="line">		item2.setPrice(<span class="number">5000f</span>);</div><div class="line">		item2.setDetail(<span class="string">"IPhone6 64G 黑色"</span>);</div><div class="line">		itemsList.add(item1);</div><div class="line">		itemsList.add(item2);</div><div class="line">		<span class="comment">// 设置模型数据</span></div><div class="line">		request.setAttribute(<span class="string">"itemsList"</span>,itemsList);</div><div class="line">		<span class="comment">// 设置转发的视图</span></div><div class="line">		request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/items/itemsList.jsp"</span>).forward(request, response);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>==多个适配器可以共存，也可以不写，因为springmvc提供了一些默认的配置==</p>
<p>==在spring-webmvc的jar包的org.springframework.web.servlet包中DispatcherServlet.properties中提供了系统的一些默认配置。==</p>
</li>
</ul>
<h1 id="四、注解的处理器映射器和适配器"><a href="#四、注解的处理器映射器和适配器" class="headerlink" title="四、注解的处理器映射器和适配器"></a>四、注解的处理器映射器和适配器</h1><blockquote>
<ul>
<li><p>spring3.1之前：</p>
<p>映射器：</p>
<p><code>org.springframework.web.servlet.mvc.annotation.DefaultAnnotationHandlerMapping</code></p>
<p>适配器：</p>
<p><code>org.springframework.web.servlet.mvc.annotation.AnnotationMethodHandlerAdapter</code></p>
</li>
<li><p>spring3.1之后：</p>
<p>映射器：</p>
<p><code>org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping</code></p>
<p>适配器：</p>
<p><code>org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter</code></p>
</li>
</ul>
</blockquote>
<h2 id="1-配置注解映射器和注解适配器"><a href="#1-配置注解映射器和注解适配器" class="headerlink" title="1.配置注解映射器和注解适配器"></a>1.配置注解映射器和注解适配器</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 注解映射器 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- &lt;bean class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerMapping"/&gt; --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 注解适配器 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- &lt;bean class="org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter"/&gt; --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 可以代替上面两个配置,并且默认加载了很多的参数绑定方法 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="2-Handler开发"><a href="#2-Handler开发" class="headerlink" title="2.Handler开发"></a>2.Handler开发</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 使用@Controller标识它是一个控制器</span></div><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsController3</span></span>&#123;</div><div class="line">	<span class="comment">// 商品查询列表</span></div><div class="line">	<span class="comment">// @RequestMapping将方法和url进行匹配，一般建议方法名和url一样，可以不加请求后缀(.action等)</span></div><div class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/queryItems"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">queryItems</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		<span class="comment">// 创建静态数据</span></div><div class="line">		List&lt;Items&gt; itemsList = <span class="keyword">new</span> ArrayList&lt;&gt;();</div><div class="line">		Items item1 = <span class="keyword">new</span> Items();</div><div class="line">		item1.setName(<span class="string">"联想笔记本"</span>);</div><div class="line">		item1.setPrice(<span class="number">6000f</span>);</div><div class="line">		item1.setDetail(<span class="string">"ThinkPad T430 联想笔记本电脑"</span>);</div><div class="line">		Items item2 = <span class="keyword">new</span> Items();</div><div class="line">		item2.setName(<span class="string">"苹果手机"</span>);</div><div class="line">		item2.setPrice(<span class="number">5000f</span>);</div><div class="line">		item2.setDetail(<span class="string">"IPhone6 64G 黑色"</span>);</div><div class="line">		itemsList.add(item1);</div><div class="line">		itemsList.add(item2);</div><div class="line">		<span class="comment">// 返回ModelAndView</span></div><div class="line">		ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</div><div class="line">		<span class="comment">// 相当于request的setAttribute方法</span></div><div class="line">		modelAndView.addObject(<span class="string">"itemsList"</span>,itemsList);</div><div class="line">		<span class="comment">// 指定视图</span></div><div class="line">		modelAndView.setViewName(<span class="string">"/WEB-INF/jsp/items/itemsList.jsp"</span>);</div><div class="line">		<span class="keyword">return</span> modelAndView;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>3.配置Handler Bean：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 单个配置 --&gt;</span></div><div class="line"><span class="comment">&lt;!-- &lt;bean class="com.ssm.controller.ItemsController3"/&gt; --&gt;</span></div><div class="line"><span class="comment">&lt;!-- 组件扫描配置 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.ssm.controller"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="五、视图解析器配置前缀和后缀"><a href="#五、视图解析器配置前缀和后缀" class="headerlink" title="五、视图解析器配置前缀和后缀"></a>五、视图解析器配置前缀和后缀</h1><h2 id="1-配置"><a href="#1-配置" class="headerlink" title="1.配置"></a>1.配置</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="2-指定视图"><a href="#2-指定视图" class="headerlink" title="2.指定视图"></a>2.指定视图</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//modelAndView.setViewName("/WEB-INF/jsp/items/itemsList.jsp");</span></div><div class="line">modelAndView.setViewName(<span class="string">"items/itemsList"</span>);</div></pre></td></tr></table></figure>
<h1 id="六、SpringMVC和MyBatis整合："><a href="#六、SpringMVC和MyBatis整合：" class="headerlink" title="六、SpringMVC和MyBatis整合："></a>六、SpringMVC和MyBatis整合：</h1><h2 id="1-需求：-使用SpringMVC和MyBatis完成商品列表查询-："><a href="#1-需求：-使用SpringMVC和MyBatis完成商品列表查询-：" class="headerlink" title="1.需求：==使用SpringMVC和MyBatis完成商品列表查询==："></a>1.需求：==使用SpringMVC和MyBatis完成商品列表查询==：</h2><h2 id="2-整合思路："><a href="#2-整合思路：" class="headerlink" title="2.整合思路："></a>2.整合思路：</h2><h3 id="2-1-整合Dao层："><a href="#2-1-整合Dao层：" class="headerlink" title="2.1 整合Dao层："></a>2.1 整合Dao层：</h3><ul>
<li>mybatis和spring整合，通过spring管理mapper接口</li>
<li>使用mapper的扫描器自动扫描mapper接口在spring中进行注册</li>
</ul>
<h3 id="2-2-整合service层："><a href="#2-2-整合service层：" class="headerlink" title="2.2 整合service层："></a>2.2 整合service层：</h3><ul>
<li>通过spring管理service接口</li>
<li>使用配置方式将service接口配置在spring配置文件中</li>
<li>实现事务控制</li>
</ul>
<h3 id="2-3-整合springmvc"><a href="#2-3-整合springmvc" class="headerlink" title="2.3 整合springmvc"></a>2.3 整合springmvc</h3><ul>
<li>由于springmvc是spring的模块，不需要整合</li>
</ul>
<h2 id="3-搭建环境"><a href="#3-搭建环境" class="headerlink" title="3.搭建环境"></a>3.搭建环境</h2><h3 id="3-1-所需要的jar包"><a href="#3-1-所需要的jar包" class="headerlink" title="3.1 所需要的jar包"></a>3.1 所需要的jar包</h3><ul>
<li>数据库驱动包、mybatis的jar包、mybatis和spring整合包、log4j包、dbcp数据库连接池包、spring的jar包、jstl包</li>
</ul>
<h3 id="3-2-工程结构："><a href="#3-2-工程结构：" class="headerlink" title="3.2 工程结构："></a>3.2 工程结构：</h3><p><img width="300" height="300" src="/2017/02/17/SpringMVC学习笔记/3_2_1.png"></p>
<h3 id="3-3-最终代码"><a href="#3-3-最终代码" class="headerlink" title="3.3 最终代码"></a>3.3 <a href="/downloads/code/SpringMVC学习笔记/SSM.zip">最终代码</a></h3><h2 id="4-整合dao"><a href="#4-整合dao" class="headerlink" title="4.整合dao"></a>4.整合dao</h2><p>mybatis和spring整合：</p>
<h3 id="4-1-sqlMapConfig-xml："><a href="#4-1-sqlMapConfig-xml：" class="headerlink" title="4.1 sqlMapConfig.xml："></a>4.1 sqlMapConfig.xml：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE configuration</span></div><div class="line">PUBLIC "-//mybatis.org//DTD Config 3.0//EN"</div><div class="line">"http://mybatis.org/dtd/mybatis-3-config.dtd"&gt;</div><div class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 全局setting配置，根据需要添加 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 配置别名 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 批量扫描别名 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">"com.ssm.po"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 配置mapper</span></div><div class="line">	由于使用spring和mybatis的整合包进行mapper扫描，这里不需要配置了。</div><div class="line">	必须遵循：mapper.xml和mapper.java文件同名且在一个目录 </div><div class="line">	 --&gt;</div><div class="line">	<span class="comment">&lt;!-- &lt;mappers&gt;	&lt;/mappers&gt; --&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="4-2-applicationContext-dao-xml"><a href="#4-2-applicationContext-dao-xml" class="headerlink" title="4.2 applicationContext-dao.xml"></a>4.2 applicationContext-dao.xml</h3><p>配置：数据源、SqlSessionFactory、mapper扫描器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 加载db.properties文件中的内容，db.properties文件中key命名要有一定的特殊规则 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">"classpath:db.properties"</span> /&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 配置数据源(dbcp) --&gt;</span>	</div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"dataSource"</span> <span class="attr">class</span>=<span class="string">"org.apache.commons.dbcp.BasicDataSource"</span></span></div><div class="line">		<span class="attr">destroy-method</span>=<span class="string">"close"</span>&gt;</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"driverClassName"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"url"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"username"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.username&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"password"</span> <span class="attr">value</span>=<span class="string">"$&#123;jdbc.password&#125;"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxActive"</span> <span class="attr">value</span>=<span class="string">"30"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxIdle"</span> <span class="attr">value</span>=<span class="string">"5"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- sqlSessionFactory --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"sqlSessionFactory"</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.SqlSessionFactoryBean"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 数据库连接池 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span> /&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 加载mybatis的全局配置文件 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"configLocation"</span> <span class="attr">value</span>=<span class="string">"classpath:mybatis/sqlMapConfig.xml"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- mapper扫描器 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.mybatis.spring.mapper.MapperScannerConfigurer"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 扫描包路径，如果需要扫描多个包，中间使用半角逗号隔开 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basePackage"</span> <span class="attr">value</span>=<span class="string">"com.ssm.mapper"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"sqlSessionFactoryBeanName"</span> <span class="attr">value</span>=<span class="string">"sqlSessionFactory"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="4-3-逆向工程生成po类及mapper-单表CRUD"><a href="#4-3-逆向工程生成po类及mapper-单表CRUD" class="headerlink" title="4.3 逆向工程生成po类及mapper(单表CRUD)"></a>4.3 逆向工程生成po类及mapper(单表CRUD)</h3><ul>
<li><strong>过程如附录一</strong></li>
</ul>
<h3 id="4-4-手动定义商品查询mapper"><a href="#4-4-手动定义商品查询mapper" class="headerlink" title="4.4 手动定义商品查询mapper"></a>4.4 手动定义商品查询mapper</h3><p>针对综合查询mapper，一般情况会有关联查询，建议自定义mapper</p>
<ul>
<li><p>ItemsMapperCustom.java</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ItemsMapperCustom</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;ItemsCustom&gt; <span class="title">findItemsList</span><span class="params">(ItemsQueryVo itemsQueryVo)</span> <span class="keyword">throws</span> Exception</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>ItemsMapperCustom.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">"com.ssm.mapper.ItemsMapperCustom"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">"query_items_where"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 使用动态sql,通过if判断，满足条件进行sql拼接 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"itemsCustom!=null"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">if</span> <span class="attr">test</span>=<span class="string">"itemsCustom.name!=null and itemsCustom.name!=''"</span>&gt;</span></div><div class="line">				items.name LIKE '%$&#123;itemsCustom.name&#125;%'</div><div class="line">			<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">if</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">sql</span>&gt;</span></div><div class="line">  <span class="comment">&lt;!-- 商品列表查询 --&gt;</span></div><div class="line">  <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">"findItemsList"</span> <span class="attr">parameterType</span>=<span class="string">"com.ssm.po.ItemsQueryVo"</span> <span class="attr">resultType</span>=<span class="string">"com.ssm.po.ItemsCustom"</span>&gt;</span></div><div class="line">  	SELECT * FROM items</div><div class="line">  	<span class="tag">&lt;<span class="name">where</span>&gt;</span></div><div class="line">  		<span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">"query_items_where"</span>&gt;</span><span class="tag">&lt;/<span class="name">include</span>&gt;</span></div><div class="line">  	<span class="tag">&lt;/<span class="name">where</span>&gt;</span></div><div class="line">  <span class="tag">&lt;/<span class="name">select</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>ItemsCustom.java—商品的扩展类(不要在mybatis生成的po类中扩展)</p>
</li>
<li><p>ItemsQueryVo.java—商品的包装类</p>
</li>
</ul>
<h2 id="5-整合service"><a href="#5-整合service" class="headerlink" title="5.整合service"></a>5.整合service</h2><p>让spring管理service接口</p>
<h3 id="5-1-定义service接口"><a href="#5-1-定义service接口" class="headerlink" title="5.1 定义service接口"></a>5.1 定义service接口</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ItemsService</span> </span>&#123;</div><div class="line">	<span class="comment">// 商品查询列表</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;ItemsCustom&gt; <span class="title">findItemsList</span><span class="params">(ItemsQueryVo itemsQueryVo)</span> <span class="keyword">throws</span> Exception</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>实现接口：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsServiceImpl</span> <span class="keyword">implements</span> <span class="title">ItemsService</span> </span>&#123;</div><div class="line">	<span class="meta">@Autowired</span></div><div class="line">	<span class="keyword">private</span> ItemsMapperCustom itemsMapperCustom;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;ItemsCustom&gt; <span class="title">findItemsList</span><span class="params">(ItemsQueryVo itemsQueryVo)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="comment">// 通过itemsMapperCustom查询数据库</span></div><div class="line">		<span class="keyword">return</span> itemsMapperCustom.findItemsList(itemsQueryVo);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="5-2-在Spring容器中配置Service"><a href="#5-2-在Spring容器中配置Service" class="headerlink" title="5.2 在Spring容器中配置Service"></a>5.2 在Spring容器中配置Service</h3><ul>
<li><p>创建applicationContext-service.xml，并配置service接口</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 定义商品管理的service --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"itemsService"</span> <span class="attr">class</span>=<span class="string">"com.ssm.service.ItemsService"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="5-3-事务控制—applicationContext-transaction-xml"><a href="#5-3-事务控制—applicationContext-transaction-xml" class="headerlink" title="5.3 事务控制—applicationContext-transaction.xml"></a>5.3 事务控制—applicationContext-transaction.xml</h3><ul>
<li><p>在applicationContext-transaction.xml中使用spring的声明式方法进行配置</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 事务管理器，对mybatis操作数据库事务控制，spring使用jdbc的事务控制类 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"transactionManager"</span> <span class="attr">class</span>=<span class="string">"org.springframework.jdbc.datasource.DataSourceTransactionManager"</span>&gt;</span></div><div class="line">		<span class="comment">&lt;!-- 数据源 --&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"dataSource"</span> <span class="attr">ref</span>=<span class="string">"dataSource"</span>&gt;</span><span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 通知 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">"txAdvice"</span> <span class="attr">transaction-manager</span>=<span class="string">"transactionManager"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></div><div class="line">			<span class="comment">&lt;!-- 传播行为 --&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"save*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"delete*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"insert*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"update*"</span> <span class="attr">propagation</span>=<span class="string">"REQUIRED"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"find*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"get*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">"select*"</span> <span class="attr">propagation</span>=<span class="string">"SUPPORTS"</span> <span class="attr">read-only</span>=<span class="string">"true"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- aop --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">"txAdvice"</span> <span class="attr">pointcut</span>=<span class="string">"execution(* com.ssm.service.impl.*.*(..))"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="6-整合springmvc"><a href="#6-整合springmvc" class="headerlink" title="6.整合springmvc"></a>6.整合springmvc</h2><h3 id="6-1-创建springmvc-xml文件，配置处理器映射器、适配器、视图解析器"><a href="#6-1-创建springmvc-xml文件，配置处理器映射器、适配器、视图解析器" class="headerlink" title="6.1 创建springmvc.xml文件，配置处理器映射器、适配器、视图解析器"></a>6.1 创建springmvc.xml文件，配置处理器映射器、适配器、视图解析器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">beans</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 组件扫描配置 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">"com.ssm.controller"</span>&gt;</span><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></div><div class="line">    <span class="comment">&lt;!-- 注解映射器、注解适配器 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">mvc:annotation-driven</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 视图解析器 --&gt;</span></div><div class="line">	<span class="comment">&lt;!-- jsp视图解析器,默认使用jstl标签，classpath下需要有jstl的包 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span></span></div><div class="line">		<span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.view.InternalResourceViewResolver"</span>&gt;</div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"prefix"</span> <span class="attr">value</span>=<span class="string">"/WEB-INF/jsp/"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suffix"</span> <span class="attr">value</span>=<span class="string">".jsp"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="6-2-配置前端控制器"><a href="#6-2-配置前端控制器" class="headerlink" title="6.2 配置前端控制器"></a>6.2 配置前端控制器</h3><ul>
<li>参考入门程序中的配置</li>
</ul>
<h3 id="6-3-开发controller"><a href="#6-3-开发controller" class="headerlink" title="6.3 开发controller"></a>6.3 开发controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsController</span> </span>&#123;</div><div class="line">	<span class="meta">@Autowired</span></div><div class="line">	<span class="keyword">private</span> ItemsService itemService;</div><div class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/queryItems"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">queryItems</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		List&lt;ItemsCustom&gt; itemsList = itemService.findItemsList(<span class="keyword">null</span>);</div><div class="line">		ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</div><div class="line">		modelAndView.addObject(<span class="string">"itemsList"</span>,itemsList);</div><div class="line">		modelAndView.setViewName(<span class="string">"items/itemsList"</span>);</div><div class="line">		<span class="keyword">return</span> modelAndView;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="6-4-编写jsp：itemsList-jsp"><a href="#6-4-编写jsp：itemsList-jsp" class="headerlink" title="6.4 编写jsp：itemsList.jsp"></a>6.4 编写jsp：<a href="/downloads/code/SpringMVC学习笔记/2_itemsList.jsp">itemsList.jsp</a></h3><h2 id="7-加载spring容器"><a href="#7-加载spring容器" class="headerlink" title="7.加载spring容器"></a>7.加载spring容器</h2><ul>
<li><p>将mapper、service、controller加载到spring容器中</p>
<p><img src="/2017/02/17/SpringMVC学习笔记/Users/chenping/Documents/blog/qjbagugit.github.io/source/_posts/SpringMVC学习笔记/6_7_1.png" alt="6_7_1"></p>
</li>
<li><p>建议使用通配符加载上面的配置文件</p>
<p>在web.xml中，添加spring容器监听器，加载spring容器</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 加载spring容器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>/WEB-INF/classes/spring/applicationContext-*.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="七、商品修改功能的开发"><a href="#七、商品修改功能的开发" class="headerlink" title="七、商品修改功能的开发"></a>七、商品修改功能的开发</h1><h2 id="1-分析："><a href="#1-分析：" class="headerlink" title="1.分析："></a>1.分析：</h2><ul>
<li>进入商品查询列表界面</li>
<li>点击修改，进入商品修改页面(商品详细信息根据id从数据库查询)</li>
<li>在商品修改页面，修改商品信息后，点击提交</li>
</ul>
<h2 id="2-开发mapper"><a href="#2-开发mapper" class="headerlink" title="2.开发mapper"></a>2.开发mapper</h2><ul>
<li><p>mapper：</p>
<p>​    根据id查询商品信息</p>
<p>​    根据id更新items表的数据</p>
</li>
<li><p>不用开发，使用逆向工程生成的</p>
</li>
</ul>
<h2 id="3-开发service"><a href="#3-开发service" class="headerlink" title="3.开发service"></a>3.开发service</h2><ul>
<li><p>接口功能：</p>
<p>​    根据id查询商品信息</p>
<p>​    修改商品信息</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ItemsService</span> </span>&#123;</div><div class="line">	<span class="comment">// 商品查询列表</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;ItemsCustom&gt; <span class="title">findItemsList</span><span class="params">(ItemsQueryVo itemsQueryVo)</span> <span class="keyword">throws</span> Exception</span>;</div><div class="line">	<span class="comment">// 根据id查询商品信息</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ItemsCustom <span class="title">findItemsById</span><span class="params">(<span class="keyword">int</span> id)</span> <span class="keyword">throws</span> Exception</span>;</div><div class="line">	<span class="comment">// 修改商品信息</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateItems</span><span class="params">(<span class="keyword">int</span> id, ItemsCustom itemsCustom)</span></span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>接口实现：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ItemsServiceImpl</span> <span class="keyword">implements</span> <span class="title">ItemsService</span> </span>&#123;</div><div class="line">	<span class="meta">@Autowired</span></div><div class="line">	<span class="keyword">private</span> ItemsMapperCustom itemsMapperCustom;</div><div class="line">	<span class="meta">@Autowired</span></div><div class="line">	<span class="keyword">private</span> ItemsMapper itemsMapper;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> List&lt;ItemsCustom&gt; <span class="title">findItemsList</span><span class="params">(ItemsQueryVo itemsQueryVo)</span><span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		<span class="comment">// 通过itemsMapperCustom查询数据库</span></div><div class="line">		<span class="keyword">return</span> itemsMapperCustom.findItemsList(itemsQueryVo);</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ItemsCustom <span class="title">findItemsById</span><span class="params">(Integer id)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		Items items = itemsMapper.selectByPrimaryKey(id);</div><div class="line">		<span class="comment">// 中间对商品信息进行业务处理...</span></div><div class="line">		ItemsCustom itemsCustom = <span class="keyword">new</span> ItemsCustom();</div><div class="line">		<span class="comment">// 将items的值拷贝到itemsCustom</span></div><div class="line">		BeanUtils.copyProperties(items, itemsCustom);</div><div class="line">		<span class="keyword">return</span> itemsCustom;</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateItems</span><span class="params">(Integer id, ItemsCustom itemsCustom)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="comment">// 添加业务校验，通常在service接口对关键数据进行校验</span></div><div class="line">		itemsCustom.setId(id);</div><div class="line">		itemsMapper.updateByPrimaryKeyWithBLOBs(itemsCustom);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>​</p>
</li>
</ul>
<h2 id="4-开发controller"><a href="#4-开发controller" class="headerlink" title="4.开发controller"></a>4.开发controller</h2><p>方法：</p>
<p>​    商品详细信息展示</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItems"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editItems</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">// 这里先用静态数据id</span></div><div class="line">	ItemsCustom itemsCustom = itemService.findItemsById(<span class="number">2</span>);</div><div class="line">	ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</div><div class="line">	modelAndView.addObject(<span class="string">"itemsCustom"</span>,itemsCustom);</div><div class="line">	modelAndView.setViewName(<span class="string">"items/editItems"</span>);</div><div class="line">	<span class="keyword">return</span> modelAndView;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>​    商品详细信息修改提交</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItemsSubmit"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editItemsSubmit</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">// todo：后面再具体业务实现</span></div><div class="line">	ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</div><div class="line">	modelAndView.setViewName(<span class="string">"success"</span>);</div><div class="line">	<span class="keyword">return</span> modelAndView;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h1 id="八、-RequestMapping"><a href="#八、-RequestMapping" class="headerlink" title="八、@RequestMapping"></a>八、@RequestMapping</h1><ul>
<li>定义controller方法对应的url，进行处理器映射使用。</li>
</ul>
<h2 id="1-URL路径映射："><a href="#1-URL路径映射：" class="headerlink" title="1.URL路径映射："></a>1.URL路径映射：</h2><ul>
<li><code>@RequestMapping(value=&quot;/item&quot;)或@RequestMapping(&quot;/item)</code></li>
<li>value的值是数组，可以将多个url映射到同一个方法</li>
</ul>
<h2 id="2-窄化请求映射："><a href="#2-窄化请求映射：" class="headerlink" title="2.窄化请求映射："></a>2.窄化请求映射：</h2><ul>
<li><p>在class上添加@RequestMapping(url)指定通用请求前缀，限制此类下的所有方法请求url必须以请求前缀开头，通过此方法对url进行分类管理。</p>
</li>
<li><p>例如：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// @RequestMapping放在类名上边，设置请求前缀 </span></div><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/item"</span>)</div><div class="line"></div><div class="line"><span class="comment">// @RequestMapping放在方法名上边，如下：</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/queryItem "</span>)</div><div class="line"></div><div class="line"><span class="comment">// 最终访问地址为：/item/queryItem</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="3-限制请求方法："><a href="#3-限制请求方法：" class="headerlink" title="3.限制请求方法："></a>3.限制请求方法：</h2><ul>
<li><code>@RequestMapping(method = RequestMethod.GET)</code></li>
<li><code>@RequestMapping(method={RequestMethod.GET,RequestMethod.POST})</code></li>
</ul>
<h1 id="九、Controller方法的返回值："><a href="#九、Controller方法的返回值：" class="headerlink" title="九、Controller方法的返回值："></a>九、Controller方法的返回值：</h1><h2 id="1-返回ModelAndView"><a href="#1-返回ModelAndView" class="headerlink" title="1.返回ModelAndView:"></a>1.返回ModelAndView:</h2><ul>
<li>controller方法中定义ModelAndView对象并返回，对象中可添加model数据、指定view。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItems"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> ModelAndView <span class="title">editItems</span><span class="params">()</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">// 这里先用静态数据id</span></div><div class="line">	ItemsCustom itemsCustom = itemService.findItemsById(<span class="number">2</span>);</div><div class="line">	ModelAndView modelAndView = <span class="keyword">new</span> ModelAndView();</div><div class="line">	modelAndView.addObject(<span class="string">"itemsCustom"</span>,itemsCustom);</div><div class="line">	modelAndView.setViewName(<span class="string">"items/editItems"</span>);</div><div class="line">	<span class="keyword">return</span> modelAndView;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="2-返回String："><a href="#2-返回String：" class="headerlink" title="2.返回String："></a>2.返回String：</h2><h3 id="2-1-逻辑视图名"><a href="#2-1-逻辑视图名" class="headerlink" title="2.1 逻辑视图名:"></a>2.1 逻辑视图名:</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItems"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editItems</span><span class="params">(Model model)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	<span class="comment">// 相当于ModelAndView的addObject方法</span></div><div class="line">	ItemsCustom itemsCustom = itemService.findItemsById(<span class="number">2</span>);</div><div class="line">	model.addAttribute(<span class="string">"itemsCustom"</span>,itemsCustom);</div><div class="line">	<span class="keyword">return</span> <span class="string">"items/editItems"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-2-Redirect重定向"><a href="#2-2-Redirect重定向" class="headerlink" title="2.2  Redirect重定向:"></a>2.2  Redirect重定向:</h3><ul>
<li>Contrller方法返回结果重定向到一个url地址，如下商品修改提交后重定向到商品查询方法，参数无法带到商品查询方法中。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//重定向到queryItem.action地址,request无法带过去</span></div><div class="line"><span class="keyword">return</span> <span class="string">"redirect:queryItem.action"</span>;</div></pre></td></tr></table></figure>
<ul>
<li>redirect方式相当于“response.sendRedirect()”，转发后浏览器的地址栏变为转发后的地址，因为转发即执行了一个新的request和response。由于新发起一个request原来的参数在转发时就不能传递到下一个url，如果要传参数可以<code>/item/queryItem.action</code>后边加参数，如:<code>/item/queryItem?key&amp;value</code></li>
</ul>
<h3 id="2-3-forward转发"><a href="#2-3-forward转发" class="headerlink" title="2.3 forward转发:"></a>2.3 forward转发:</h3><ul>
<li>controller方法执行后继续执行另一个controller方法，如下商品修改提交后转向到商品修改页面，修改商品的id参数可以带到商品修改方法中。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//结果转发到editItem.action，request可以带过去</span></div><div class="line"><span class="keyword">return</span> <span class="string">"forward:editItem.action"</span>;</div></pre></td></tr></table></figure>
<ul>
<li>forward方式相当于“request.getRequestDispatcher().forward(request,response)”，转发后浏览器地址栏还是原来的地址。转发并没有执行新的request和response，而是和转发前的请求共用一个request和response。所以转发前请求的参数在转发后仍然可以读取到。</li>
</ul>
<h2 id="3-返回void："><a href="#3-返回void：" class="headerlink" title="3.返回void："></a>3.返回void：</h2><ul>
<li><p>在controller方法形参上可以定义request和response，使用request或response指定响应结果：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">editItemsSubmit</span><span class="params">(HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> Exception</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="3-1-使用request转向页面："><a href="#3-1-使用request转向页面：" class="headerlink" title="3.1 使用request转向页面："></a>3.1 使用request转向页面：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">request.getRequestDispatcher(<span class="string">"页面路径"</span>).forward(request, response);</div></pre></td></tr></table></figure>
<h3 id="3-2-通过response页面重定向："><a href="#3-2-通过response页面重定向：" class="headerlink" title="3.2 通过response页面重定向："></a>3.2 通过response页面重定向：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">response.sendRedirect(<span class="string">"url"</span>)</div></pre></td></tr></table></figure>
<h3 id="3-3-通过response指定响应结果，例如响应json数据如下："><a href="#3-3-通过response指定响应结果，例如响应json数据如下：" class="headerlink" title="3.3 通过response指定响应结果，例如响应json数据如下："></a>3.3 通过response指定响应结果，例如响应json数据如下：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">response.setCharacterEncoding(<span class="string">"utf-8"</span>);</div><div class="line">response.setContentType(<span class="string">"application/json;charset=utf-8"</span>);</div><div class="line">response.getWriter().write(<span class="string">"json串"</span>);</div></pre></td></tr></table></figure>
<h1 id="十、参数绑定："><a href="#十、参数绑定：" class="headerlink" title="十、参数绑定："></a>十、参数绑定：</h1><ul>
<li>处理器适配器在执行Handler之前需要把http请求的key/value数据绑定到Handler方法形参数上。</li>
</ul>
<h2 id="1-默认支持的参数类型"><a href="#1-默认支持的参数类型" class="headerlink" title="1.  默认支持的参数类型"></a>1.  默认支持的参数类型</h2><ul>
<li>处理器形参中添加如下类型的参数处理适配器会默认识别并进行赋值。</li>
</ul>
<h3 id="1-1-HttpServletRequest"><a href="#1-1-HttpServletRequest" class="headerlink" title="1.1  HttpServletRequest"></a>1.1  HttpServletRequest</h3><ul>
<li>通过request对象获取请求信息</li>
</ul>
<h3 id="1-2-HttpServletResponse"><a href="#1-2-HttpServletResponse" class="headerlink" title="1.2 HttpServletResponse"></a>1.2 HttpServletResponse</h3><ul>
<li>通过response处理响应信息</li>
</ul>
<h3 id="1-3-HttpSession"><a href="#1-3-HttpSession" class="headerlink" title="1.3 HttpSession"></a>1.3 HttpSession</h3><ul>
<li>通过session对象得到session中存放的对象</li>
</ul>
<h3 id="1-4-Model-ModelMap"><a href="#1-4-Model-ModelMap" class="headerlink" title="1.4 Model/ModelMap"></a>1.4 Model/ModelMap</h3><ul>
<li>ModelMap是Model接口的实现类，通过Model或ModelMap向页面传递数据</li>
</ul>
<h2 id="2-参数绑定介绍"><a href="#2-参数绑定介绍" class="headerlink" title="2. 参数绑定介绍"></a>2. 参数绑定介绍</h2><ul>
<li>注解适配器对RequestMapping标记的方法进行适配，对方法中的形参会进行参数绑定，早期springmvc采用PropertyEditor（属性编辑器）进行参数绑定将request请求的参数绑定到方法形参上，3.X之后springmvc就开始使用Converter进行参数绑定。</li>
</ul>
<h3 id="2-1-简单类型："><a href="#2-1-简单类型：" class="headerlink" title="2.1 简单类型："></a>2.1 简单类型：</h3><ul>
<li><p>当请求的参数名称和处理器形参名称一致时会将请求参数与形参进行绑定。</p>
</li>
<li><p>使用@RequestParam常用于处理简单类型的绑定</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// value:请求参数名，required:是否必须，默认true,defaultValue:默认值</span></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editItem</span><span class="params">(@RequestParam(value=<span class="string">"item_id"</span>,required=<span class="keyword">true</span>)</span> String id) </span>&#123;&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-2-pojo类型："><a href="#2-2-pojo类型：" class="headerlink" title="2.2 pojo类型："></a>2.2 pojo类型：</h3><ul>
<li><p>简单pojo：将pojo对象中的属性名于传递进来的属性名对应，如果传进来的参数名称和对象中的属性名称一致则将参数值设置在pojo对象中</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 页面定义如下;</span></div><div class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"name"</span>/&gt;</div><div class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"price"</span>/&gt;</div><div class="line"><span class="comment">// Contrller方法定义如下：</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItemSubmit"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editItemSubmit</span><span class="params">(Items items)</span><span class="keyword">throws</span> Exception</span>&#123;&#125;</div><div class="line"><span class="comment">// 请求的参数名称和pojo的属性名称一致，会自动将请求参数赋值给pojo的属性。</span></div></pre></td></tr></table></figure>
</li>
<li><p>包装pojo：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 包装对象定义如下：</span></div><div class="line">Public <span class="class"><span class="keyword">class</span> <span class="title">QueryVo</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> Items items;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 页面定义：</span></div><div class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"items.name"</span> /&gt;</div><div class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"items.price"</span> /&gt;</div><div class="line"><span class="comment">// Controller方法定义如下：</span></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">useraddsubmit</span><span class="params">(Model model,QueryVo queryVo)</span><span class="keyword">throws</span> Exception</span>&#123;&#125;</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-3-自定义参数绑定："><a href="#2-3-自定义参数绑定：" class="headerlink" title="2.3 自定义参数绑定："></a>2.3 自定义参数绑定：</h3><ul>
<li><p>需求：根据业务需求自定义日期格式进行参数绑定。将日期字符串转成java.util.Date。</p>
</li>
<li><p>自定义参数Converter</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomDateConverter</span> <span class="keyword">implements</span> <span class="title">Converter</span>&lt;<span class="title">String</span>, <span class="title">Date</span>&gt; </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> Date <span class="title">convert</span><span class="params">(String source)</span> </span>&#123;</div><div class="line">		<span class="keyword">try</span> &#123;</div><div class="line">			SimpleDateFormat simpleDateFormat = <span class="keyword">new</span> SimpleDateFormat(<span class="string">"yyyy-MM-dd HH:mm:ss"</span>);</div><div class="line">			<span class="keyword">return</span> simpleDateFormat.parse(source);</div><div class="line">		&#125; <span class="keyword">catch</span> (Exception e) &#123;</div><div class="line">			e.printStackTrace();</div><div class="line">		&#125;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">null</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>注入配置：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">conversion-service</span>=<span class="string">"conversionService"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"conversionService"</span>		<span class="attr">class</span>=<span class="string">"org.springframework.format.support.FormattingConversionServiceFactoryBean"</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 转换器 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"converters"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">list</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.ssm.controller.converter.CustomDateConverter"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-4-集合类型："><a href="#2-4-集合类型：" class="headerlink" title="2.4 集合类型："></a>2.4 集合类型：</h3><ul>
<li><p>字符串数组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 页面定义如下：</span></div><div class="line">&lt;input type=<span class="string">"checkbox"</span> name=<span class="string">"item_id"</span> value=<span class="string">"001"</span>/&gt;</div><div class="line">&lt;input type=<span class="string">"checkbox"</span> name=<span class="string">"item_id"</span> value=<span class="string">"002"</span>/&gt;</div><div class="line">&lt;input type=<span class="string">"checkbox"</span> name=<span class="string">"item_id"</span> value=<span class="string">"002"</span>/&gt;</div><div class="line"><span class="comment">// 传递到controller方法中的格式是：001,002,003</span></div><div class="line"><span class="comment">// Controller方法中可以用String[]接收，定义如下：</span></div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">deleteitem</span><span class="params">(String[] item_id)</span><span class="keyword">throws</span> Exception</span></div></pre></td></tr></table></figure>
</li>
<li><p>List：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line">// List中存放对象，并将定义的List放在包装类中，action使用包装对象接收。</div><div class="line">Public class QueryVo &#123;</div><div class="line">   	Private List&lt;Items&gt; itemList;//商品列表</div><div class="line"> 	//get/set方法..</div><div class="line">&#125;</div><div class="line">// 页面定义如下：</div><div class="line">&lt;tr&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name=" itemsList[0].id" value="$&#123;item.id&#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name=" itemsList[0].name" value="$&#123;item.name &#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name=" itemsList[0].price" value="$&#123;item.price&#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;/tr&gt;</div><div class="line">&lt;tr&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name=" itemsList[1].id" value="$&#123;item.id&#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name=" itemsList[1].name" value="$&#123;item.name &#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name=" itemsList[1].price" value="$&#123;item.price&#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;/tr&gt;</div><div class="line">// 动态jsp代码如下：</div><div class="line">&lt;c:forEach items="$&#123;itemsList &#125;" var="item" varStatus="s"&gt;</div><div class="line">&lt;tr&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name="itemsList[$&#123;s.index &#125;].name" value="$&#123;item.name &#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;td&gt;&lt;input type="text" name="itemsList[$&#123;s.index &#125;].price" value="$&#123;item.price &#125;"/&gt;&lt;/td&gt;</div><div class="line">	.....</div><div class="line">	.....</div><div class="line">&lt;/tr&gt;</div><div class="line">&lt;/c:forEach&gt;</div><div class="line">// Contrller方法定义如下：</div><div class="line">public String useraddsubmit(Model model,QueryVo queryVo)throws Exception;</div></pre></td></tr></table></figure>
</li>
<li><p>Map：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">// 在包装类中定义Map对象，并添加get/set方法，action使用包装对象接收。</div><div class="line">Public class QueryVo &#123;</div><div class="line">	private Map&lt;String, Object&gt; itemInfo = new HashMap&lt;String, Object&gt;();</div><div class="line">  	//get/set方法..</div><div class="line">&#125;</div><div class="line">// 页面定义如下：</div><div class="line">&lt;tr&gt;</div><div class="line">&lt;td&gt;学生信息：&lt;/td&gt;</div><div class="line">&lt;td&gt;</div><div class="line">姓名：&lt;inputtype="text"name="itemInfo['name']"/&gt;</div><div class="line">年龄：&lt;inputtype="text"name="itemInfo['price']"/&gt;</div><div class="line">.. .. ..</div><div class="line">&lt;/td&gt;</div><div class="line">&lt;/tr&gt;</div><div class="line">// Contrller方法定义如下：</div><div class="line">public String useraddsubmit(Model model,QueryVo queryVo)throws Exception;</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="十一、校验："><a href="#十一、校验：" class="headerlink" title="十一、校验："></a>十一、校验：</h1><h2 id="1-校验说明："><a href="#1-校验说明：" class="headerlink" title="1.校验说明："></a>1.校验说明：</h2><ul>
<li>b/s系统中对http请求数据的校验多数在客户端进行，这也是出于简单及用户体验性上考虑，但是在一些安全性要求高的系统中服务端校验是不可缺少的，本节主要学习springmvc实现控制层添加校验。</li>
<li>控制层Controller：校验页面请求参数的合法性。</li>
<li>业务层Service：主要校验关键业务参数，仅限于service接口中使用的参数。</li>
<li>持久层Dao：一般不校验。</li>
</ul>
<h2 id="2-SpringMVC校验："><a href="#2-SpringMVC校验：" class="headerlink" title="2.SpringMVC校验："></a>2.SpringMVC校验：</h2><ul>
<li>Spring3支持JSR-303验证框架，JSR-303 是JAVA EE 6 中的一项子规范，叫做Bean Validation，官方参考实现是Hibernate Validator（与Hibernate ORM 没有关系），JSR 303 用于对Java Bean 中的字段的值进行验证。</li>
</ul>
<h3 id="2-1-需求："><a href="#2-1-需求：" class="headerlink" title="2.1 需求："></a>2.1 需求：</h3><ul>
<li>在商品信息修改提交时对商品信息内容进行校验，例如商品名称必须输入，价格合法性校验。</li>
</ul>
<h3 id="2-2-加入相关的jar包："><a href="#2-2-加入相关的jar包：" class="headerlink" title="2.2 加入相关的jar包："></a>2.2 加入相关的jar包：</h3><p><img src="/2017/02/17/SpringMVC学习笔记/11_2_1.png" alt="11_2_1"></p>
<h3 id="2-3-配置validator"><a href="#2-3-配置validator" class="headerlink" title="2.3 配置validator:"></a>2.3 配置validator:</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 校验器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"validator"</span></span></div><div class="line">	<span class="attr">class</span>=<span class="string">"org.springframework.validation.beanvalidation.LocalValidatorFactoryBean"</span>&gt;</div><div class="line">	<span class="comment">&lt;!-- hibernate校验器 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"providerClass"</span> <span class="attr">value</span>=<span class="string">"org.hibernate.validator.HibernateValidator"</span> /&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 指定校验使用的资源文件,在文件中配置校验错误信息，如果不指定则默认使用classpath下的ValidationMessages.properties --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"validationMessageSource"</span> <span class="attr">ref</span>=<span class="string">"messageSource"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 校验错误信息配置文件 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"messageSource"</span></span></div><div class="line">	<span class="attr">class</span>=<span class="string">"org.springframework.context.support.ReloadableResourceBundleMessageSource"</span>&gt;</div><div class="line">	<span class="comment">&lt;!-- 资源文件名 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"basenames"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">list</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">value</span>&gt;</span>classpath:CustomValidationMessages<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 资源文件编码格式 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"fileEncodings"</span> <span class="attr">value</span>=<span class="string">"utf-8"</span> /&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 对资源文件内容缓存时间，单位秒 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"cacheSeconds"</span> <span class="attr">value</span>=<span class="string">"120"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="2-4-将validator加到处理器适配器"><a href="#2-4-将validator加到处理器适配器" class="headerlink" title="2.4 将validator加到处理器适配器"></a>2.4 将validator加到处理器适配器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span> <span class="attr">validator</span>=<span class="string">"validator"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:annotation-driven</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="2-5-添加校验规则："><a href="#2-5-添加校验规则：" class="headerlink" title="2.5 添加校验规则："></a>2.5 添加校验规则：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Items</span> </span>&#123;</div><div class="line">    <span class="keyword">private</span> Integer id;</div><div class="line">    <span class="meta">@Size</span>(min=<span class="number">1</span>,max=<span class="number">10</span>,message=<span class="string">"&#123;items.name.length.error&#125;"</span>)</div><div class="line">    <span class="keyword">private</span> String name;</div><div class="line">    <span class="meta">@NotNull</span>(message=<span class="string">"&#123;items.createtime.isnull&#125;"</span>)</div><div class="line">    <span class="keyword">private</span> Date createtime;</div><div class="line">  	......</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-6-错误消息文件CustomValidationMessages-properties"><a href="#2-6-错误消息文件CustomValidationMessages-properties" class="headerlink" title="2.6 错误消息文件CustomValidationMessages.properties"></a>2.6 错误消息文件CustomValidationMessages.properties</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">items.name.length.error=商品名称的长度为1-30</div><div class="line">items.createtime.isnull=商品时间不能为空</div></pre></td></tr></table></figure>
<ul>
<li>如果在eclipse中编辑properties文件无法看到中文则添加propedit插件。</li>
</ul>
<h3 id="2-7-捕获错误："><a href="#2-7-捕获错误：" class="headerlink" title="2.7 捕获错误："></a>2.7 捕获错误：</h3><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">// 控制器</div><div class="line">// 在需要校验的pojo参数前添加@Validated，并在其后添加BindingResult bindingResult参数接收校验出错信息</div><div class="line">// 注意@Validated和BindingResult成对出现，并且顺序不变</div><div class="line">@RequestMapping("/editItemsSubmit")</div><div class="line">public String editItemsSubmit(Model model, HttpServletRequest request,Integer id,@Validated ItemsCustom itemsCustom, BindingResult bindingResult) throws Exception&#123;</div><div class="line">	if(bindingResult.hasErrors())&#123;</div><div class="line">		List&lt;ObjectError&gt; allErrors = bindingResult.getAllErrors();</div><div class="line">		for(ObjectError error : allErrors)&#123;</div><div class="line">			System.out.println(error.getCode()+"--&gt;"+error.getDefaultMessage());</div><div class="line">		&#125;</div><div class="line">      	// 将错误信息传到页面</div><div class="line">		model.addAttribute("allErrors", allErrors);</div><div class="line">	&#125;</div><div class="line">	itemService.updateItems(id, itemsCustom);</div><div class="line">	return "forward:queryItems.action";</div><div class="line">&#125;</div><div class="line">// jsp页面</div><div class="line">&lt;c:if test="$&#123;allErrors!=null &#125;"&gt;</div><div class="line">&lt;c:forEach items="$&#123;allErrors &#125;" var="error"&gt;</div><div class="line">	$&#123;error.defaultMessage &#125;&lt;br&gt;</div><div class="line">&lt;/c:forEach&gt;</div><div class="line">&lt;/c:if&gt;</div></pre></td></tr></table></figure>
<h3 id="2-8-分组校验："><a href="#2-8-分组校验：" class="headerlink" title="2.8 分组校验："></a>2.8 分组校验：</h3><ul>
<li><p>如果两处校验使用同一个Items类则可以设定校验分组，通过分组校验可以对每处的校验个性化。</p>
</li>
<li><p>实际需求：商品修改只校验商品名称长度</p>
</li>
<li><p>定义分组：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ValidGroup1</span> </span>&#123;</div><div class="line">&#125;</div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">ValidGroup2</span> </span>&#123;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
<li><p>pojo类指定分组校验：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Size</span>(min=<span class="number">1</span>,max=<span class="number">10</span>,message=<span class="string">"&#123;items.name.length.error&#125;"</span>,groups=&#123;ValidGroup1.class&#125;)</div><div class="line"><span class="keyword">private</span> String name;</div></pre></td></tr></table></figure>
</li>
<li><p>controller方法修改：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItemsSubmit"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editItemsSubmit</span><span class="params">(Model model, HttpServletRequest request,Integer id,@Validated(value=ValidGroup1.class)</span> ItemsCustom itemsCustom, BindingResult bindingResult) <span class="keyword">throws</span> Exception</span></div></pre></td></tr></table></figure>
</li>
<li><p>在@Validated中添加value={ValidGroup1.class}表示商品修改使用了ValidGroup1分组校验规则，也可以指定多个分组中间用逗号分隔:</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Validated</span>(value=&#123;ValidGroup1.class，ValidGroup2.class &#125;)</div></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="2-9-校验注解："><a href="#2-9-校验注解：" class="headerlink" title="2.9 校验注解："></a>2.9 校验注解：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line">@Null   被注释的元素必须为 null   </div><div class="line">@NotNull    被注释的元素必须不为 null   </div><div class="line">@AssertTrue     被注释的元素必须为 true   </div><div class="line">@AssertFalse    被注释的元素必须为 false   </div><div class="line">@Min(value)     被注释的元素必须是一个数字，其值必须大于等于指定的最小值   </div><div class="line">@Max(value)     被注释的元素必须是一个数字，其值必须小于等于指定的最大值   </div><div class="line">@DecimalMin(value)  被注释的元素必须是一个数字，其值必须大于等于指定的最小值   </div><div class="line">@DecimalMax(value)  被注释的元素必须是一个数字，其值必须小于等于指定的最大值   </div><div class="line">@Size(max=, min=)   被注释的元素的大小必须在指定的范围内   </div><div class="line">@Digits (integer, fraction)     被注释的元素必须是一个数字，其值必须在可接受的范围内   </div><div class="line">@Past   被注释的元素必须是一个过去的日期   </div><div class="line">@Future     被注释的元素必须是一个将来的日期   </div><div class="line">@Pattern(regex=,flag=)  被注释的元素必须符合指定的正则表达式   </div><div class="line">Hibernate Validator 附加的 constraint   </div><div class="line">@NotBlank(message =)   验证字符串非null，且长度必须大于0   </div><div class="line">@Email  被注释的元素必须是电子邮箱地址   </div><div class="line">@Length(min=,max=)  被注释的字符串的大小必须在指定的范围内   </div><div class="line">@NotEmpty   被注释的字符串的必须非空   </div><div class="line">@Range(min=,max=,message=)  被注释的元素必须在合适的范围内</div></pre></td></tr></table></figure>
<h1 id="十二、数据回显："><a href="#十二、数据回显：" class="headerlink" title="十二、数据回显："></a>十二、数据回显：</h1><h2 id="1-需求："><a href="#1-需求：" class="headerlink" title="1.需求："></a>1.需求：</h2><ul>
<li>表单提交失败需要再回到表单页面重新填写，原来提交的数据需要重新在页面上显示。</li>
</ul>
<h2 id="2-简单数据类型："><a href="#2-简单数据类型：" class="headerlink" title="2. 简单数据类型："></a>2. 简单数据类型：</h2><ul>
<li><p>对于简单数据类型，如：Integer、String、Float等使用Model将传入的参数再放到request域实现数据回显。</p>
<p><code>model.addAttribute(&quot;id&quot;, id)</code></p>
</li>
</ul>
<h2 id="3-pojo类型："><a href="#3-pojo类型：" class="headerlink" title="3.pojo类型："></a>3.pojo类型：</h2><ul>
<li>springmvc默认支持pojo数据回显，springmvc自动将形参中的pojo重新放回request域中，request的key为pojo的类名（首字母小写），如下：</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line">// controller方法：</div><div class="line">// springmvc自动将itemsCustom放回request，相当于调用下边的代码：</div><div class="line">// model.addAttribute("itemsCustom", itemsCustom);</div><div class="line">@RequestMapping("/editItemsSubmit")</div><div class="line">public String editItemsSubmit(Model model,Integer id,@Validated(value=ValidGroup1.class) ItemsCustom itemsCustom, BindingResult bindingResult) throws Exception&#123;</div><div class="line">	if(bindingResult.hasErrors())&#123;</div><div class="line">		List&lt;ObjectError&gt; allErrors = bindingResult.getAllErrors();</div><div class="line">		model.addAttribute("allErrors", allErrors);</div><div class="line">		return "items/editItems";</div><div class="line">	&#125;</div><div class="line">	itemService.updateItems(id, itemsCustom);</div><div class="line">	return "forward:queryItems.action";</div><div class="line">&#125;</div><div class="line">// jsp页面</div><div class="line">&lt;tr&gt;</div><div class="line">	&lt;td&gt;商品名称&lt;/td&gt;</div><div class="line">	&lt;td&gt;&lt;input type="text" name="name" value="$&#123;itemsCustom.name &#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;/tr&gt;</div><div class="line">&lt;tr&gt;</div><div class="line">	&lt;td&gt;商品价格&lt;/td&gt;</div><div class="line">	&lt;td&gt;&lt;input type="text" name="price" value="$&#123;itemsCustom.price &#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;/tr&gt;</div></pre></td></tr></table></figure>
<h2 id="4-ModelAttribute作用"><a href="#4-ModelAttribute作用" class="headerlink" title="4.@ModelAttribute作用"></a>4.@ModelAttribute作用</h2><ul>
<li><p>对于页面key和controller中方法的pojo形参名不一致的情况,可以使用@ModelAttribute完成数据回显。此作用可实现数据回显效果。</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line">@RequestMapping("/editItemsSubmit")</div><div class="line">public String editItemsSubmit(Model model,Integer id,@ModelAttribute("items") @Validated(value=ValidGroup1.class) ItemsCustom itemsCustom, BindingResult bindingResult) throws Exception&#123;</div><div class="line">	if(bindingResult.hasErrors())&#123;</div><div class="line">		List&lt;ObjectError&gt; allErrors = bindingResult.getAllErrors();</div><div class="line">		model.addAttribute("allErrors", allErrors);</div><div class="line">		return "items/editItems";</div><div class="line">	&#125;</div><div class="line">	itemService.updateItems(id, itemsCustom);</div><div class="line">	return "forward:queryItems.action";</div><div class="line">&#125;</div><div class="line">// jsp页面</div><div class="line">&lt;tr&gt;</div><div class="line">	&lt;td&gt;商品名称&lt;/td&gt;</div><div class="line">	&lt;td&gt;&lt;input type="text" name="name" value="$&#123;items.name &#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;/tr&gt;</div><div class="line">&lt;tr&gt;</div><div class="line">	&lt;td&gt;商品价格&lt;/td&gt;</div><div class="line">	&lt;td&gt;&lt;input type="text" name="price" value="$&#123;items.price &#125;"/&gt;&lt;/td&gt;</div><div class="line">&lt;/tr&gt;</div><div class="line">// 如果不用@ModelAttribute也可以使用model.addAttribute("item", itemsCustom)完成数据回显。</div></pre></td></tr></table></figure>
</li>
<li><p>将方法返回值暴露为模型数据传到视图页面</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line">// Controller方法：</div><div class="line">//商品分类</div><div class="line">@ModelAttribute("itemtypes")</div><div class="line">public Map&lt;String, String&gt; getItemTypes()&#123;		</div><div class="line">	Map&lt;String, String&gt; itemTypes = new HashMap&lt;String,String&gt;();</div><div class="line">	itemTypes.put("101", "数码");</div><div class="line">	itemTypes.put("102", "母婴");		</div><div class="line">	return itemTypes;</div><div class="line">&#125;</div><div class="line">// 页面：</div><div class="line">&lt;select name="itemtype"&gt;</div><div class="line">	&lt;c:forEach items="$&#123;itemtypes &#125;" var="itemtype"&gt;</div><div class="line">		&lt;option value="$&#123;itemtype.key &#125;"&gt;$&#123;itemtype.value &#125;&lt;/option&gt;		</div><div class="line">	&lt;/c:forEach&gt;</div><div class="line">&lt;/select&gt;</div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="十三、异常处理器"><a href="#十三、异常处理器" class="headerlink" title="十三、异常处理器"></a>十三、异常处理器</h1><ul>
<li>springmvc在处理请求过程中出现异常信息交由异常处理器进行处理，自定义异常处理器可以实现一个系统的异常处理逻辑。</li>
</ul>
<h2 id="1-异常处理思路："><a href="#1-异常处理思路：" class="headerlink" title="1.异常处理思路："></a>1.异常处理思路：</h2><ul>
<li><p>系统中异常包括两类：预期异常和运行时异常RuntimeException，前者通过捕获异常从而获取异常信息，后者主要通过规范代码开发、测试通过手段减少运行时异常的发生。</p>
</li>
<li><p>系统的dao、service、controller出现都通过throws Exception向上抛出，最后由springmvc前端控制器交由异常处理器进行异常处理，如下图：</p>
<p><img width="500" height="500" src="/2017/02/17/SpringMVC学习笔记/13_1_1.png"></p>
</li>
</ul>
<h2 id="2-自定义异常类："><a href="#2-自定义异常类：" class="headerlink" title="2.自定义异常类："></a>2.自定义异常类：</h2><h3 id="2-1自定义异常类："><a href="#2-1自定义异常类：" class="headerlink" title="2.1自定义异常类："></a>2.1自定义异常类：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomException</span> <span class="keyword">extends</span> <span class="title">Exception</span> </span>&#123;</div><div class="line">	<span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</div><div class="line">	<span class="keyword">private</span> String message;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="title">CustomException</span><span class="params">(String message)</span> </span>&#123;</div><div class="line">		<span class="keyword">super</span>();</div><div class="line">		<span class="keyword">this</span>.message = message;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">getMessage</span><span class="params">()</span> </span>&#123;</div><div class="line">		<span class="keyword">return</span> message;</div><div class="line">	&#125;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">setMessage</span><span class="params">(String message)</span> </span>&#123;</div><div class="line">		<span class="keyword">this</span>.message = message;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="2-2自定义异常处理类："><a href="#2-2自定义异常处理类：" class="headerlink" title="2.2自定义异常处理类："></a>2.2自定义异常处理类：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomExceptionResolver</span> <span class="keyword">implements</span> <span class="title">HandlerExceptionResolver</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> ModelAndView <span class="title">resolveException</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object obj,Exception ex)</span> </span>&#123;</div><div class="line">		ex.printStackTrace();</div><div class="line">		CustomException customException = <span class="keyword">null</span>;</div><div class="line">		<span class="keyword">if</span>(ex <span class="keyword">instanceof</span> CustomException)&#123;</div><div class="line">			customException = (CustomException) ex;</div><div class="line">		&#125;<span class="keyword">else</span>&#123;</div><div class="line">			customException = <span class="keyword">new</span> CustomException(<span class="string">"未知错误，请与系统管理 员联系！"</span>);</div><div class="line">		&#125;</div><div class="line">		ModelAndView model = <span class="keyword">new</span> ModelAndView();</div><div class="line">		model.addObject(<span class="string">"message"</span>, customException.getMessage());</div><div class="line">		model.setViewName(<span class="string">"error"</span>);</div><div class="line">		<span class="keyword">return</span> model;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3-将异常处理类添加到spring容器："><a href="#3-将异常处理类添加到spring容器：" class="headerlink" title="3.将异常处理类添加到spring容器："></a>3.将异常处理类添加到spring容器：</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 全局异常处理 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.ssm.exception.CustomExceptionResolver"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="4-Controller方法抛出异常："><a href="#4-Controller方法抛出异常：" class="headerlink" title="4.Controller方法抛出异常："></a>4.Controller方法抛出异常：</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItems"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editItems</span><span class="params">(Model model, Integer id)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	ItemsCustom itemsCustom = itemService.findItemsById(id);</div><div class="line">	<span class="keyword">if</span>(itemsCustom == <span class="keyword">null</span>)&#123;</div><div class="line">		<span class="keyword">throw</span> <span class="keyword">new</span> CustomException(<span class="string">"商品信息不能为空！"</span>);</div><div class="line">	&#125;</div><div class="line">	model.addAttribute(<span class="string">"items"</span>,itemsCustom);</div><div class="line">	<span class="keyword">return</span> <span class="string">"items/editItems"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="5-异常显示页面："><a href="#5-异常显示页面：" class="headerlink" title="5.异常显示页面："></a>5.异常显示页面：</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>错误提示<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line">$&#123;message &#125;</div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="十四、图片上传"><a href="#十四、图片上传" class="headerlink" title="十四、图片上传"></a>十四、图片上传</h1><h2 id="1-需求"><a href="#1-需求" class="headerlink" title="1.需求"></a>1.需求</h2><ul>
<li>在修改商品页面，添加上传商品图片功能。</li>
</ul>
<h2 id="2-配置虚拟路径："><a href="#2-配置虚拟路径：" class="headerlink" title="2.配置虚拟路径："></a>2.配置虚拟路径：</h2><h3 id="2-1-Tomcat配置："><a href="#2-1-Tomcat配置：" class="headerlink" title="2.1 Tomcat配置："></a>2.1 Tomcat配置：</h3><ul>
<li>在tomcat下conf/server.xml中添加：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Context</span> <span class="attr">docBase</span>=<span class="string">"F:\develop\upload\temp"</span> <span class="attr">path</span>=<span class="string">"/pic"</span> <span class="attr">reloadable</span>=<span class="string">"false"</span>/&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>访问<a href="http://localhost:8080/pic即可访问F:\develop\upload\temp下的图片" target="_blank" rel="external">http://localhost:8080/pic即可访问F:\develop\upload\temp下的图片</a></li>
</ul>
<h3 id="2-2-Eclipse配置："><a href="#2-2-Eclipse配置：" class="headerlink" title="2.2 Eclipse配置："></a>2.2 Eclipse配置：</h3><p><img width="700" height="300" src="/2017/02/17/SpringMVC学习笔记/14_2_1.png"></p>
<ul>
<li>==实际项目中一般会采用独立的图片服务器，且图片目录最好按日期建立，可以提高io性能==</li>
</ul>
<h2 id="2-配置springmvc对多部件类型的解析"><a href="#2-配置springmvc对多部件类型的解析" class="headerlink" title="2.配置springmvc对多部件类型的解析"></a>2.配置springmvc对多部件类型的解析</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 文件上传 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"multipartResolver"</span></span></div><div class="line">	<span class="attr">class</span>=<span class="string">"org.springframework.web.multipart.commons.CommonsMultipartResolver"</span>&gt;</div><div class="line">	<span class="comment">&lt;!-- 设置上传文件的最大尺寸为5MB --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"maxUploadSize"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">value</span>&gt;</span>5242880<span class="tag">&lt;/<span class="name">value</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="3-相关的Jar包"><a href="#3-相关的Jar包" class="headerlink" title="3.相关的Jar包"></a>3.相关的Jar包</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">commons-fileupload-1.3.2.jar</div><div class="line">commons-io-2.5.jar</div></pre></td></tr></table></figure>
<h2 id="4-图片上传："><a href="#4-图片上传：" class="headerlink" title="4.图片上传："></a>4.图片上传：</h2><ul>
<li>Controller方法：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/editItemsSubmit"</span>)</div><div class="line"><span class="function"><span class="keyword">public</span> String <span class="title">editItemsSubmit</span><span class="params">(Model model, HttpServletRequest request,Integer id,</span></span></div><div class="line">		@ModelAttribute(<span class="string">"items"</span>) @<span class="title">Validated</span><span class="params">(value=ValidGroup1.class)</span> ItemsCustom itemsCustom, BindingResult bindingResult,</div><div class="line">		MultipartFile items_pic) <span class="keyword">throws</span> Exception&#123;</div><div class="line">	...<span class="comment">//其他操作</span></div><div class="line">	<span class="keyword">if</span>(items_pic!=<span class="keyword">null</span>)&#123;</div><div class="line">		String originFileName = items_pic.getOriginalFilename();</div><div class="line">		<span class="keyword">if</span>(originFileName!=<span class="keyword">null</span> &amp;&amp; originFileName.length()&gt;<span class="number">0</span>)&#123;</div><div class="line">			String pic_path = <span class="string">"/Users/chenping/Documents/workspace/uploads/"</span>;</div><div class="line">			String newFileName = UUID.randomUUID() + originFileName.substring(originFileName.indexOf(<span class="string">"."</span>));</div><div class="line">			File newFile = <span class="keyword">new</span> File(pic_path+newFileName);</div><div class="line">          	<span class="comment">//向磁盘写文件</span></div><div class="line">			items_pic.transferTo(newFile);</div><div class="line">			itemsCustom.setPic(newFileName);</div><div class="line">		&#125;</div><div class="line">	&#125;</div><div class="line">	itemService.updateItems(id, itemsCustom);</div><div class="line">	<span class="keyword">return</span> <span class="string">"forward:queryItems.action"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>jsp页面：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">id</span>=<span class="string">"itemForm"</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/item/editItemsSubmit.action"</span> <span class="attr">method</span>=<span class="string">"post"</span> <span class="attr">enctype</span>=<span class="string">"multipart/form-data"</span>&gt;</span></div><div class="line"><span class="comment">&lt;!-- 注意这行代码 --&gt;</span></div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"pic"</span> <span class="attr">value</span>=<span class="string">"$&#123;items.pic &#125;"</span> /&gt;</span></div><div class="line">...</div><div class="line"><span class="tag">&lt;<span class="name">tr</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span>商品图片<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">td</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$&#123;items.pic !=null&#125;"</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"/pic/$&#123;items.pic&#125;"</span> <span class="attr">width</span>=<span class="string">100</span> <span class="attr">height</span>=<span class="string">100/</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">br</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"file"</span>  <span class="attr">name</span>=<span class="string">"items_pic"</span> <span class="attr">value</span>=<span class="string">"/pic/$&#123;items.pic&#125;"</span>/&gt;</span> </div><div class="line">	<span class="tag">&lt;/<span class="name">td</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">tr</span>&gt;</span></div><div class="line">...</div></pre></td></tr></table></figure>
<ul>
<li><p>为了防止重复提交时，因为未选择图片，而将原来的图片信息删除，可以添加如下代码：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"pic"</span> <span class="attr">value</span>=<span class="string">"$&#123;items.pic &#125;"</span> /&gt;</span></div></pre></td></tr></table></figure>
</li>
</ul>
<h1 id="十五、Json数据交互："><a href="#十五、Json数据交互：" class="headerlink" title="十五、Json数据交互："></a>十五、Json数据交互：</h1><h2 id="1-注解说明："><a href="#1-注解说明：" class="headerlink" title="1.注解说明："></a>1.注解说明：</h2><h3 id="1-1-RequestBody："><a href="#1-1-RequestBody：" class="headerlink" title="1.1  @RequestBody："></a>1.1  @RequestBody：</h3><ul>
<li>@RequestBody注解用于读取http请求的内容(字符串)，通过springmvc提供的HttpMessageConverter接口将读到的内容转换为json、xml等格式的数据并绑定到controller方法的参数上。</li>
<li>本例子应用：@RequestBody注解实现接收http请求的json数据，将json数据转换为java对象</li>
</ul>
<h3 id="1-2-ResponseBody"><a href="#1-2-ResponseBody" class="headerlink" title="1.2  @ResponseBody"></a>1.2  @ResponseBody</h3><ul>
<li>用于将Controller的方法返回的对象，通过HttpMessageConverter接口转换为指定格式的数据如：json,xml等，通过Response响应给客户端</li>
<li>本例子应用：@ResponseBody注解实现将controller方法返回对象转换为json响应给客户端</li>
</ul>
<h2 id="2-准备环境："><a href="#2-准备环境：" class="headerlink" title="2.准备环境："></a>2.准备环境：</h2><h3 id="2-1-添加相关的Jar包："><a href="#2-1-添加相关的Jar包：" class="headerlink" title="2.1 添加相关的Jar包："></a>2.1 添加相关的Jar包：</h3><p><img width="400" height="100" src="/2017/02/17/SpringMVC学习笔记/15_2_1.png"></p>
<h3 id="2-2-springmvc配置："><a href="#2-2-springmvc配置：" class="headerlink" title="2.2 springmvc配置："></a>2.2 springmvc配置：</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--注解适配器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"messageConverters"</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">list</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"org.springframework.http.converter.json.MappingJacksonHttpMessageConverter"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>==注意：如果使用 则不用定义上边的内容。==</li>
</ul>
<h2 id="3-请求json响应json："><a href="#3-请求json响应json：" class="headerlink" title="3.请求json响应json："></a>3.请求json响应json：</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// @RequestBody 将请求的json串转换成java对象</span></div><div class="line"><span class="comment">// @ResponseBody 将java对象转成json串</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/requestJson"</span>)</div><div class="line"><span class="keyword">public</span> <span class="meta">@ResponseBody</span> <span class="function">ItemsCustom <span class="title">requestJson</span><span class="params">(@RequestBody ItemsCustom itemsCustom)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	itemsCustom = itemsService.findItemsById(itemsCustom.getId());</div><div class="line">	<span class="keyword">return</span> itemsCustom;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img width="500" height="600" src="/2017/02/17/SpringMVC学习笔记/15_3_1.png"></p>
<h2 id="4-请求key-value响应json："><a href="#4-请求key-value响应json：" class="headerlink" title="4.请求key/value响应json："></a>4.请求key/value响应json：</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/responseJson"</span>)</div><div class="line"><span class="keyword">public</span> <span class="meta">@ResponseBody</span> <span class="function">ItemsCustom <span class="title">responseJson</span><span class="params">(ItemsCustom itemsCustom)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	itemsCustom = itemsService.findItemsById(itemsCustom.getId());</div><div class="line">	<span class="keyword">return</span> itemsCustom;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><img width="500" height="600" src="/2017/02/17/SpringMVC学习笔记/15_4_1.png"></p>
<ul>
<li>jsonTest.jsp</li>
</ul>
<figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line">&lt;title&gt;json交互测试&lt;/title&gt;</div><div class="line">&lt;script type="text/javascript" src="$&#123;pageContext.request.contextPath &#125;/js/jquery-1.4.4.min.js"&gt;&lt;/script&gt;</div><div class="line">&lt;script type="text/javascript"&gt;</div><div class="line">	function requestJson()&#123;</div><div class="line">		$.ajax(&#123;</div><div class="line">			type:'post',</div><div class="line">			url:'$&#123;pageContext.request.contextPath &#125;/requestJson.action',</div><div class="line">          	// 以json格式请求</div><div class="line">			contentType:'application/json;charset=utf-8',</div><div class="line">			data:'&#123;"id":1, "name":"手机", "price":666&#125;',</div><div class="line">			success:function(data)&#123;</div><div class="line">				alert(data.name);</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">	&#125;</div><div class="line">	function responseJson()&#123;</div><div class="line">		$.ajax(&#123;</div><div class="line">			type:'post',</div><div class="line">			url:'$&#123;pageContext.request.contextPath &#125;/responseJson.action',</div><div class="line">			// 请求key/value，不需要指定contentType，默认就是key/value</div><div class="line">			//contentType:'application/json;charset=utf-8',</div><div class="line">			data:'id=2&amp;price=666',</div><div class="line">			success:function(data)&#123;</div><div class="line">				alert(data.name);</div><div class="line">			&#125;</div><div class="line">		&#125;);</div><div class="line">	&#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;/head&gt;</div><div class="line">&lt;body&gt;</div><div class="line">	&lt;input type="button" onclick="requestJson()" value="请求json，输出json"/&gt;</div><div class="line">	&lt;input type="button" onclick="responseJson()" value="请求KV，输出json"/&gt;</div><div class="line">&lt;/body&gt;</div><div class="line">&lt;/html&gt;</div></pre></td></tr></table></figure>
<h1 id="十六、RESTful支持"><a href="#十六、RESTful支持" class="headerlink" title="十六、RESTful支持"></a>十六、RESTful支持</h1><h2 id="1-什么是RESTful"><a href="#1-什么是RESTful" class="headerlink" title="1.什么是RESTful"></a>1.什么是RESTful</h2><ul>
<li>RESTful（即Representational State Transfer的缩写）其实是一个开发理念，是对http的很好的诠释。</li>
</ul>
<h3 id="1-1-对Url进行规范，写RESTful格式的Url"><a href="#1-1-对Url进行规范，写RESTful格式的Url" class="headerlink" title="1.1 对Url进行规范，写RESTful格式的Url"></a>1.1 对Url进行规范，写RESTful格式的Url</h3><blockquote>
<ul>
<li><p>非REST的url：<a href="http://....../queryItems.action?id=001&amp;type=T01" target="_blank" rel="external">http://....../queryItems.action?id=001&amp;type=T01</a></p>
</li>
<li><p>REST的url风格：<a href="http://....../items/001" target="_blank" rel="external">http://....../items/001</a></p>
<p><strong>特点：url简洁，将参数通过url传到服务端</strong></p>
</li>
</ul>
</blockquote>
<h3 id="1-2-对http的方法规范"><a href="#1-2-对http的方法规范" class="headerlink" title="1.2 对http的方法规范"></a>1.2 对http的方法规范</h3><ul>
<li>不管是删除、添加、更新。。使用url是一致的，如果进行删除，需要设置http的方法为delete，同理添加……</li>
<li>后台controller方法：判断http方法，如果是delete执行删除，如果是post执行添加。</li>
</ul>
<h3 id="1-3-对http的contentType规范"><a href="#1-3-对http的contentType规范" class="headerlink" title="1.3 对http的contentType规范"></a>1.3 对http的contentType规范</h3><ul>
<li>请求时指定contentType，要json数据，设置成json格式的type…..</li>
</ul>
<p>==注意：实现项目只是对Url进行规范==</p>
<h2 id="2-使用示例："><a href="#2-使用示例：" class="headerlink" title="2.使用示例："></a>2.使用示例：</h2><h3 id="2-1-需求：-1"><a href="#2-1-需求：-1" class="headerlink" title="2.1 需求："></a>2.1 需求：</h3><ul>
<li>查询商品信息，返回json数据。</li>
</ul>
<h3 id="2-2-Controller方法："><a href="#2-2-Controller方法：" class="headerlink" title="2.2 Controller方法："></a>2.2 Controller方法：</h3><ul>
<li>定义方法，进行url映射使用REST风格的url，将查询商品信息的id传入controller 。输出json使用@ResponseBody将java对象输出json。</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// /itemsview/&#123;id&#125;里面的&#123;id&#125;表示占位符，通过@PathVariable获取占位符中的参数</span></div><div class="line"><span class="comment">// 如果占位符中的名称和形参名一样，在@PathVariable可以不指定名称</span></div><div class="line"><span class="meta">@RequestMapping</span>(<span class="string">"/itemsview/&#123;id&#125;"</span>)</div><div class="line"><span class="keyword">public</span> <span class="meta">@ResponseBody</span> <span class="function">ItemsCustom <span class="title">itemsview</span><span class="params">(@PathVariable(<span class="string">"id"</span>)</span> Integer id) <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">	ItemsCustom itemsCustom = itemService.findItemsById(id);</div><div class="line">	<span class="keyword">return</span> itemsCustom;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>@RequestMapping(value=”/ itemsView/{id}”)：{×××}占位符，请求的URL可以是“/viewItems/1”或“/viewItems/2”，通过在方法中使用@PathVariable获取{×××}中的×××变量</li>
<li>@PathVariable用于将请求URL中的模板变量映射到功能处理方法的参数上。如果RequestMapping中表示为”/ itemsView /{id}”，id和形参名称一致，@PathVariable<strong>不用指定名称</strong>。</li>
</ul>
<h3 id="2-3-前端控制器配置："><a href="#2-3-前端控制器配置：" class="headerlink" title="2.3 前端控制器配置："></a>2.3 前端控制器配置：</h3><ul>
<li>因为REST风格的url没有.action后缀，所以需要重新配置前端控制器；可以和原来配置的前端控制器共存。</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- RESTful前端控制器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc_rest<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:spring/springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>springmvc_rest<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="2-4-静态资源解析："><a href="#2-4-静态资源解析：" class="headerlink" title="2.4 静态资源解析："></a>2.4 静态资源解析：</h3><ul>
<li>同样REST风格的url也会影响到静态资源的获取，可以在springmvc.xml中通过以下配置解决：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 静态资源解析，包括：js、css、img --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/js/"</span> <span class="attr">mapping</span>=<span class="string">"/js/**"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">location</span>=<span class="string">"/img/"</span> <span class="attr">mapping</span>=<span class="string">"/img/**"</span>&gt;</span><span class="tag">&lt;/<span class="name">mvc:resources</span>&gt;</span></div></pre></td></tr></table></figure>
<h1 id="十七、拦截器："><a href="#十七、拦截器：" class="headerlink" title="十七、拦截器："></a>十七、拦截器：</h1><h2 id="1-定义："><a href="#1-定义：" class="headerlink" title="1.定义："></a>1.定义：</h2><ul>
<li>Spring Web MVC 的处理器拦截器类似于Servlet开发中的过滤器Filter，用于对处理器进行预处理和后处理。</li>
</ul>
<h2 id="2-拦截器实现："><a href="#2-拦截器实现：" class="headerlink" title="2.拦截器实现："></a>2.拦截器实现：</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HandlerInterceptor1</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * controller执行前调用此方法</div><div class="line">	 * 返回true表示继续执行，返回false中止执行</div><div class="line">	 * 这里可以加入登录校验、权限拦截等</div><div class="line">	 */</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object obj)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * controller执行后但未返回视图前调用此方法</div><div class="line">	 * 这里可在返回用户前对模型数据进行加工处理，比如这里加入公用信息以便页面显示</div><div class="line">	 */</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object obj,ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">/**</span></div><div class="line">	 * controller执行后且视图返回后调用此方法</div><div class="line">	 * 这里可得到执行controller时的异常信息</div><div class="line">	 * 这里可记录操作日志，资源清理等</div><div class="line">	 */</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object obj,Exception exception)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h2 id="3-拦截器配置："><a href="#3-拦截器配置：" class="headerlink" title="3.拦截器配置："></a>3.拦截器配置：</h2><h3 id="3-1-针对某种mapping配置拦截器"><a href="#3-1-针对某种mapping配置拦截器" class="headerlink" title="3.1 针对某种mapping配置拦截器"></a>3.1 针对某种mapping配置拦截器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 不常用 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span></span></div><div class="line">	<span class="attr">class</span>=<span class="string">"org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping"</span>&gt;</div><div class="line">	<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"interceptors"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">list</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"handlerInterceptor1"</span>/&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">ref</span> <span class="attr">bean</span>=<span class="string">"handlerInterceptor2"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">list</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">property</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"handlerInterceptor1"</span> <span class="attr">class</span>=<span class="string">"springmvc.intercapter.HandlerInterceptor1"</span>/&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">"handlerInterceptor2"</span> <span class="attr">class</span>=<span class="string">"springmvc.intercapter.HandlerInterceptor2"</span>/&gt;</span></div></pre></td></tr></table></figure>
<h3 id="3-2-针对所有mapping配置全局拦截器"><a href="#3-2-针对所有mapping配置全局拦截器" class="headerlink" title="3.2 针对所有mapping配置全局拦截器"></a>3.2 针对所有mapping配置全局拦截器</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!--拦截器 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!--多个拦截器,顺序执行 --&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"cn.itcast.springmvc.filter.HandlerInterceptor1"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span>/&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"cn.itcast.springmvc.filter.HandlerInterceptor2"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="4-拦截流程测试："><a href="#4-拦截流程测试：" class="headerlink" title="4.拦截流程测试："></a>4.拦截流程测试：</h2><ul>
<li>HandlerInterceptor1和HandlerInterceptor2配置如上</li>
</ul>
<h3 id="4-1-正常流程测试："><a href="#4-1-正常流程测试：" class="headerlink" title="4.1 正常流程测试："></a>4.1 正常流程测试：</h3><ul>
<li><p>定义两个拦截器分别为：HandlerInterceptor1和HandlerInteptor2，每个拦截器的preHandler方法都返回true(即不拦截)。</p>
</li>
<li><p>运行流程：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">HandlerInterceptor1..preHandle..</div><div class="line">HandlerInterceptor2..preHandle..</div><div class="line"></div><div class="line">HandlerInterceptor2..postHandle..</div><div class="line">HandlerInterceptor1..postHandle..</div><div class="line"></div><div class="line">HandlerInterceptor2..afterCompletion..</div><div class="line">HandlerInterceptor1..afterCompletion..</div></pre></td></tr></table></figure>
</li>
<li><p>总结：<strong>preHandle方法按顺序执行，postHandle和afterCompletion按拦截器配置的逆向顺序执行。</strong></p>
</li>
</ul>
<h3 id="4-2-中断流程测试："><a href="#4-2-中断流程测试：" class="headerlink" title="4.2 中断流程测试："></a>4.2 中断流程测试：</h3><ul>
<li><p>定义两个拦截器分别为：HandlerInterceptor1和HandlerInteptor2。</p>
</li>
<li><p>运行流程：</p>
<p>(1). HandlerInterceptor1的preHandler方法返回false，HandlerInterceptor2返回true，运行流程如下：</p>
<p><code>HandlerInterceptor1..preHandle..</code></p>
<p>从日志看出第一个拦截器的preHandler方法返回false后第一个拦截器只执行了preHandler方法，其它两个方法没有执行，第二个拦截器的所有方法不执行，且controller也不执行了。</p>
<p>(2).HandlerInterceptor1的preHandler方法返回true，HandlerInterceptor2返回false，运行流程如下：</p>
<p><code>HandlerInterceptor1..preHandle..</code></p>
<p><code>HandlerInterceptor2..preHandle..</code></p>
<p><code>HandlerInterceptor1..afterCompletion..</code></p>
<p>从日志看出第二个拦截器的preHandler方法返回false后第一个拦截器的postHandler没有执行，第二个拦截器的postHandler和afterCompletion没有执行，且controller也不执行了。</p>
</li>
<li><p>总结：</p>
<p><strong>preHandle按拦截器定义顺序调用</strong></p>
<p><strong>postHandler按拦截器定义逆序调用</strong></p>
<p><strong>afterCompletion按拦截器定义逆序调用</strong></p>
<p><strong>postHandler在拦截器链内所有拦截器返成功调用</strong></p>
<p><strong>afterCompletion只有preHandle返回true才调用</strong></p>
</li>
</ul>
<h2 id="5-拦截器应用："><a href="#5-拦截器应用：" class="headerlink" title="5.拦截器应用："></a>5.拦截器应用：</h2><h3 id="5-1-需求："><a href="#5-1-需求：" class="headerlink" title="5.1 需求："></a>5.1 需求：</h3><ul>
<li>用户请求url</li>
<li>拦截器进行拦截校验<ul>
<li>如果请求的url是公开地址(无需登陆即可访问的url),则放行。</li>
<li>如果用户session 不存在跳转到登陆页面。</li>
<li>如果用户session存在则放行，继续操作。</li>
</ul>
</li>
</ul>
<h3 id="5-2-登录Controller实现："><a href="#5-2-登录Controller实现：" class="headerlink" title="5.2 登录Controller实现："></a>5.2 登录Controller实现：</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="meta">@Controller</span></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginConroller</span> </span>&#123;</div><div class="line">	<span class="comment">// 登录</span></div><div class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/login"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(HttpSession session,String username, String password)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		session.setAttribute(<span class="string">"username"</span>, username);</div><div class="line">		<span class="keyword">return</span> <span class="string">"redirect:/item/queryItems.action"</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="comment">// 退出</span></div><div class="line">	<span class="meta">@RequestMapping</span>(<span class="string">"/logout"</span>)</div><div class="line">	<span class="function"><span class="keyword">public</span> String <span class="title">logout</span><span class="params">(HttpSession session)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		session.invalidate();</div><div class="line">		<span class="keyword">return</span> <span class="string">"redirect:/item/queryItems.action"</span>;</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="5-3-登录认证拦截实现："><a href="#5-3-登录认证拦截实现：" class="headerlink" title="5.3 登录认证拦截实现："></a>5.3 登录认证拦截实现：</h3><ul>
<li>拦截器：</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginInterceptor</span> <span class="keyword">implements</span> <span class="title">HandlerInterceptor</span> </span>&#123;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">preHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object obj)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">		String uri = request.getRequestURI();</div><div class="line">		<span class="comment">// 判断是否为公开地址(不需要进行拦截的地址)</span></div><div class="line">		<span class="keyword">if</span>(uri.indexOf(<span class="string">"login.action"</span>)&gt;<span class="number">0</span>)&#123;</div><div class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="comment">// 判断session，校验用户是否登录</span></div><div class="line">		HttpSession session = request.getSession();</div><div class="line">		String username = (String) session.getAttribute(<span class="string">"username"</span>);</div><div class="line">		<span class="keyword">if</span>(username!=<span class="keyword">null</span> &amp;&amp; username.length()&gt;<span class="number">0</span>)&#123;</div><div class="line">			<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">		&#125;</div><div class="line">		<span class="comment">// 用户未登录，跳到登录界面</span></div><div class="line">		request.getRequestDispatcher(<span class="string">"/WEB-INF/jsp/login.jsp"</span>).forward(request, response);</div><div class="line">		<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postHandle</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object obj,ModelAndView modelAndView)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	&#125;</div><div class="line">	<span class="meta">@Override</span></div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">afterCompletion</span><span class="params">(HttpServletRequest request, HttpServletResponse response, Object obj,Exception exception)</span> <span class="keyword">throws</span> Exception </span>&#123;</div><div class="line">	&#125;</div><div class="line"></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<ul>
<li>配置：</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">mvc:interceptors</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">mvc:mapping</span> <span class="attr">path</span>=<span class="string">"/**"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">bean</span> <span class="attr">class</span>=<span class="string">"com.ssm.interceptor.LoginInterceptor"</span>&gt;</span><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">mvc:interceptor</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">mvc:interceptors</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>login.jsp</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"Content-Type"</span> <span class="attr">content</span>=<span class="string">"text/html; charset=UTF-8"</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>系统登录<span class="tag">&lt;/<span class="name">title</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"$&#123;pageContext.request.contextPath &#125;/login.action"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></div><div class="line">	用户账号：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span> /&gt;</span></div><div class="line">	用户密码：<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"password"</span> <span class="attr">name</span>=<span class="string">"password"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">value</span>=<span class="string">"登录"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>itemsList.jsp中添加：</li>
</ul>
<figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">c:if</span> <span class="attr">test</span>=<span class="string">"$&#123;username!=null &#125;"</span>&gt;</span></div><div class="line">	当前用户：$&#123;username &#125;   <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">"$&#123;pageContext.request.contextPath&#125;/logout.action"</span>&gt;</span>退出<span class="tag">&lt;/<span class="name">a</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">c:if</span>&gt;</span></div></pre></td></tr></table></figure>
<h2 id="6-项目整体代码"><a href="#6-项目整体代码" class="headerlink" title="6.项目整体代码"></a>6.<a href="/downloads/code/SpringMVC学习笔记/SSM.zip">项目整体代码</a></h2><h1 id="附录一：MyBatis逆向工程："><a href="#附录一：MyBatis逆向工程：" class="headerlink" title="附录一：MyBatis逆向工程："></a>附录一：MyBatis逆向工程：</h1><ol>
<li><p><code>db.properties</code>文件：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"># 数据库驱动jar 路径</div><div class="line">drive.class.path=/Users/***/Documents/libs/mysql-connector-java-5.1.40/mysql-connector-java-5.1.40-bin.jar</div><div class="line"># 数据库连接参数</div><div class="line">jdbc.driver=com.mysql.jdbc.Driver</div><div class="line">jdbc.url=jdbc:mysql://localhost:3306/ssm1?useUnicode=true&amp;characterEncoding=utf-8&amp;useSSL=false</div><div class="line">jdbc.username=root</div><div class="line">jdbc.password=root</div><div class="line"># 包路径配置</div><div class="line">model.package=com.ssm.po</div><div class="line">dao.package=com.ssm.mapper</div><div class="line">xml.mapper.package=com.ssm.mapper</div><div class="line">target.project=/Users/***/Documents/workspace/j2eespace/SpringMVCProduct/src</div></pre></td></tr></table></figure>
<p>​</p>
</li>
<li><p><code>DBGenerator.xml</code>文件：</p>
<p>具体配置：<a href="http://www.mybatis.org/generator/configreference/xmlconfig.html" target="_blank" rel="external">http://www.mybatis.org/generator/configreference/xmlconfig.html</a></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="meta">&lt;!DOCTYPE generatorConfiguration</span></div><div class="line">  PUBLIC "-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN"</div><div class="line">  "http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd"&gt;</div><div class="line"><span class="tag">&lt;<span class="name">generatorConfiguration</span>&gt;</span></div><div class="line">	<span class="comment">&lt;!-- 配置文件路径 --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">properties</span> <span class="attr">resource</span>=<span class="string">"db.properties"</span>/&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">classPathEntry</span> <span class="attr">location</span>=<span class="string">"$&#123;drive.class.path&#125;"</span> /&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">context</span> <span class="attr">id</span>=<span class="string">"DB2Tables"</span> <span class="attr">targetRuntime</span>=<span class="string">"MyBatis3"</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">commentGenerator</span> &gt;</span>  </div><div class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressAllComments"</span> <span class="attr">value</span>=<span class="string">"false"</span>/&gt;</span><span class="comment">&lt;!-- 是否取消注释 --&gt;</span>  </div><div class="line">            <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"suppressDate"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span> <span class="comment">&lt;!-- 是否生成注释代时间戳--&gt;</span>  </div><div class="line">        <span class="tag">&lt;/<span class="name">commentGenerator</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">jdbcConnection</span> <span class="attr">driverClass</span>=<span class="string">"$&#123;jdbc.driver&#125;"</span></span></div><div class="line">			<span class="attr">connectionURL</span>=<span class="string">"$&#123;jdbc.url&#125;"</span> <span class="attr">userId</span>=<span class="string">"$&#123;jdbc.username&#125;"</span></div><div class="line">			<span class="attr">password</span>=<span class="string">"$&#123;jdbc.password&#125;"</span>&gt;</div><div class="line">		<span class="tag">&lt;/<span class="name">jdbcConnection</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">javaTypeResolver</span>&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"forceBigDecimals"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">javaTypeResolver</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">javaModelGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"$&#123;model.package&#125;"</span></span></div><div class="line">			<span class="attr">targetProject</span>=<span class="string">"$&#123;target.project&#125;"</span>&gt;</div><div class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"trimStrings"</span> <span class="attr">value</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">javaModelGenerator</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">sqlMapGenerator</span> <span class="attr">targetPackage</span>=<span class="string">"$&#123;xml.mapper.package&#125;"</span></span></div><div class="line">			<span class="attr">targetProject</span>=<span class="string">"$&#123;target.project&#125;"</span>&gt;</div><div class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">sqlMapGenerator</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">javaClientGenerator</span> <span class="attr">type</span>=<span class="string">"XMLMAPPER"</span></span></div><div class="line">			<span class="attr">targetPackage</span>=<span class="string">"$&#123;dao.package&#125;"</span> <span class="attr">targetProject</span>=<span class="string">"$&#123;target.project&#125;"</span>&gt;</div><div class="line">			<span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">"enableSubPackages"</span> <span class="attr">value</span>=<span class="string">"false"</span> /&gt;</span></div><div class="line">		<span class="tag">&lt;/<span class="name">javaClientGenerator</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"items"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"orders"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"orderdetail"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">		<span class="tag">&lt;<span class="name">table</span> <span class="attr">tableName</span>=<span class="string">"user"</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></div><div class="line">	<span class="tag">&lt;/<span class="name">context</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">generatorConfiguration</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p><code>DBGenerator.java</code>文件：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DBGenerator</span> </span>&#123;</div><div class="line">	<span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception</span>&#123;</div><div class="line">		List&lt;String&gt; warnings = <span class="keyword">new</span> ArrayList&lt;String&gt;();</div><div class="line">		   <span class="keyword">boolean</span> overwrite = <span class="keyword">true</span>;</div><div class="line">		   File configFile = <span class="keyword">new</span> File(<span class="string">"db/DBGenerator.xml"</span>);</div><div class="line">		   ConfigurationParser cp = <span class="keyword">new</span> ConfigurationParser(warnings);</div><div class="line">		   Configuration config = cp.parseConfiguration(configFile);</div><div class="line">		   DefaultShellCallback callback = <span class="keyword">new</span> DefaultShellCallback(overwrite);</div><div class="line">		   MyBatisGenerator myBatisGenerator = <span class="keyword">new</span> MyBatisGenerator(config, callback, warnings);</div><div class="line">		   myBatisGenerator.generate(<span class="keyword">null</span>);</div><div class="line">	&#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
</li>
</ol>
<h1 id="附录二：请求乱码问题："><a href="#附录二：请求乱码问题：" class="headerlink" title="附录二：请求乱码问题："></a>附录二：请求乱码问题：</h1><ol>
<li><p>POST请求乱码：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="comment">&lt;!-- 在web.xml中配置以下 --&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">init-param</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">param-value</span>&gt;</span>utf-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></div><div class="line">	<span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>GET请求乱码：</p>
<ul>
<li><p>方法1:修改tomcat配置文件添加编码与工程编码一致：</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">Connector</span> <span class="attr">URIEncoding</span>=<span class="string">"utf-8"</span> <span class="attr">connectionTimeout</span>=<span class="string">"20000"</span> <span class="attr">port</span>=<span class="string">"8080"</span> <span class="attr">protocol</span>=<span class="string">"HTTP/1.1"</span> <span class="attr">redirectPort</span>=<span class="string">"8443"</span>/&gt;</span></div></pre></td></tr></table></figure>
</li>
<li><p>方法2:对参数进行重新编码：</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">String userName = <span class="keyword">new</span> String(request.getParamter(<span class="string">"userName"</span>).getBytes(<span class="string">"ISO8859-1"</span>),<span class="string">"utf-8"</span>)</div></pre></td></tr></table></figure>
<p>​    ISO8859-1是tomcat默认编码，需要将tomcat编码后的内容按utf-8编码。</p>
</li>
</ul>
</li>
</ol>

      
    </div>

    <div>
      
        

      
    </div>

    <div>
      
        

      
    </div>


    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/技术总结/" rel="tag"># 技术总结</a>
          
            <a href="/tags/SpringMVC/" rel="tag"># SpringMVC</a>
          
        </div>
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/02/01/Retrofit使用总结/" rel="next" title="Retrofit使用总结">
                <i class="fa fa-chevron-left"></i> Retrofit使用总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/02/28/Java泛型总结/" rel="prev" title="Java泛型总结">
                Java泛型总结 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  <div class="comments" id="comments">
    
      <div class="ds-thread" data-thread-key="2017/02/17/SpringMVC学习笔记/"
           data-title="SpringMVC学习笔记" data-url="https://qjbagugit.github.io/2017/02/17/SpringMVC学习笔记/">
      </div>
    
  </div>


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap" >
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
          <img class="site-author-image" itemprop="image"
               src="/images/avatar.gif"
               alt="Timer" />
          <p class="site-author-name" itemprop="name">Timer</p>
          <p class="site-description motion-element" itemprop="description">路漫漫其修远兮，吾将上下而求索</p>
        </div>
        <nav class="site-state motion-element">
          <div class="site-state-item site-state-posts">
            <a href="/archives">
              <span class="site-state-item-count">15</span>
              <span class="site-state-item-name">日志</span>
            </a>
          </div>

          
            <div class="site-state-item site-state-categories">
              <a href="/categories">
                <span class="site-state-item-count">19</span>
                <span class="site-state-item-name">分类</span>
              </a>
            </div>
          

          
            <div class="site-state-item site-state-tags">
              <a href="/tags">
                <span class="site-state-item-count">21</span>
                <span class="site-state-item-name">标签</span>
              </a>
            </div>
          

        </nav>

        

        <div class="links-of-author motion-element">
          
        </div>

        
        

        
        
          <div class="links-of-blogroll motion-element links-of-blogroll-inline">
            <div class="links-of-blogroll-title">
              <i class="fa  fa-fw fa-globe"></i>
              原博客
            </div>
            <ul class="links-of-blogroll-list">
              
                <li class="links-of-blogroll-item">
                  <a href="http://blog.csdn.net/qjbagu/" title="CSDN博客" target="_blank">CSDN博客</a>
                </li>
              
            </ul>
          </div>
        

        


      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#一、SpringMVC介绍"><span class="nav-number">1.</span> <span class="nav-text">一、SpringMVC介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-SpringMVC框架："><span class="nav-number">1.1.</span> <span class="nav-text">1.SpringMVC框架：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-SpringMVC架构："><span class="nav-number">1.2.</span> <span class="nav-text">2.SpringMVC架构：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-架构图："><span class="nav-number">1.2.1.</span> <span class="nav-text">2.1  架构图：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-架构说明："><span class="nav-number">1.2.2.</span> <span class="nav-text">2.2 架构说明：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-组件说明："><span class="nav-number">1.2.3.</span> <span class="nav-text">2.3 组件说明：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#二、入门程序"><span class="nav-number">2.</span> <span class="nav-text">二、入门程序</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-项目介绍："><span class="nav-number">2.1.</span> <span class="nav-text">1.项目介绍：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-需求：-实现商品查询列表功能"><span class="nav-number">2.1.1.</span> <span class="nav-text">1.1 需求：==实现商品查询列表功能==</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-开发环境装备：Eclipse-tomcat"><span class="nav-number">2.1.2.</span> <span class="nav-text">1.2 开发环境装备：Eclipse+tomcat</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-建立一个WEB项目"><span class="nav-number">2.1.3.</span> <span class="nav-text">1.3 建立一个WEB项目</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-导入相关jar包："><span class="nav-number">2.1.4.</span> <span class="nav-text">1.4 导入相关jar包：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-配置前端控制器"><span class="nav-number">2.2.</span> <span class="nav-text">2.配置前端控制器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-配置处理器适配器"><span class="nav-number">2.3.</span> <span class="nav-text">3.配置处理器适配器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-在springmvc-xml中进行如下配置："><span class="nav-number">2.3.1.</span> <span class="nav-text">3.1 在springmvc.xml中进行如下配置：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-编写Handler-Controller-："><span class="nav-number">2.3.2.</span> <span class="nav-text">3.2 编写Handler(Controller)：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-配置处理器映射器"><span class="nav-number">2.4.</span> <span class="nav-text">4.配置处理器映射器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-在springmvc-xml中进行如下配置："><span class="nav-number">2.4.1.</span> <span class="nav-text">4.1 在springmvc.xml中进行如下配置：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-配置Handler："><span class="nav-number">2.4.2.</span> <span class="nav-text">4.2 配置Handler：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-配置视图解析器"><span class="nav-number">2.5.</span> <span class="nav-text">5.配置视图解析器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-在springmvc-xml中进行如下配置："><span class="nav-number">2.5.1.</span> <span class="nav-text">5.1 在springmvc.xml中进行如下配置：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-访问Url："><span class="nav-number">2.5.2.</span> <span class="nav-text">5.2 访问Url：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#三、非注解的处理器映射器和适配器"><span class="nav-number">3.</span> <span class="nav-text">三、非注解的处理器映射器和适配器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-映射器"><span class="nav-number">3.1.</span> <span class="nav-text">1.映射器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-BeanNameUrlHandlerMapping"><span class="nav-number">3.1.1.</span> <span class="nav-text">1.1 BeanNameUrlHandlerMapping</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-SimpleUrlHandlerMapping"><span class="nav-number">3.1.2.</span> <span class="nav-text">1.2 SimpleUrlHandlerMapping</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-适配器"><span class="nav-number">3.2.</span> <span class="nav-text">2.适配器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-SimpleControllerHandlerAdapter"><span class="nav-number">3.2.1.</span> <span class="nav-text">2.1 SimpleControllerHandlerAdapter</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-HttpRequestHandlerAdapter"><span class="nav-number">3.2.2.</span> <span class="nav-text">2.2 HttpRequestHandlerAdapter</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#四、注解的处理器映射器和适配器"><span class="nav-number">4.</span> <span class="nav-text">四、注解的处理器映射器和适配器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-配置注解映射器和注解适配器"><span class="nav-number">4.1.</span> <span class="nav-text">1.配置注解映射器和注解适配器</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Handler开发"><span class="nav-number">4.2.</span> <span class="nav-text">2.Handler开发</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#五、视图解析器配置前缀和后缀"><span class="nav-number">5.</span> <span class="nav-text">五、视图解析器配置前缀和后缀</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-配置"><span class="nav-number">5.1.</span> <span class="nav-text">1.配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-指定视图"><span class="nav-number">5.2.</span> <span class="nav-text">2.指定视图</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#六、SpringMVC和MyBatis整合："><span class="nav-number">6.</span> <span class="nav-text">六、SpringMVC和MyBatis整合：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-需求：-使用SpringMVC和MyBatis完成商品列表查询-："><span class="nav-number">6.1.</span> <span class="nav-text">1.需求：==使用SpringMVC和MyBatis完成商品列表查询==：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-整合思路："><span class="nav-number">6.2.</span> <span class="nav-text">2.整合思路：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-整合Dao层："><span class="nav-number">6.2.1.</span> <span class="nav-text">2.1 整合Dao层：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-整合service层："><span class="nav-number">6.2.2.</span> <span class="nav-text">2.2 整合service层：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-整合springmvc"><span class="nav-number">6.2.3.</span> <span class="nav-text">2.3 整合springmvc</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-搭建环境"><span class="nav-number">6.3.</span> <span class="nav-text">3.搭建环境</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-所需要的jar包"><span class="nav-number">6.3.1.</span> <span class="nav-text">3.1 所需要的jar包</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-工程结构："><span class="nav-number">6.3.2.</span> <span class="nav-text">3.2 工程结构：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-最终代码"><span class="nav-number">6.3.3.</span> <span class="nav-text">3.3 最终代码</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-整合dao"><span class="nav-number">6.4.</span> <span class="nav-text">4.整合dao</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-sqlMapConfig-xml："><span class="nav-number">6.4.1.</span> <span class="nav-text">4.1 sqlMapConfig.xml：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-applicationContext-dao-xml"><span class="nav-number">6.4.2.</span> <span class="nav-text">4.2 applicationContext-dao.xml</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-逆向工程生成po类及mapper-单表CRUD"><span class="nav-number">6.4.3.</span> <span class="nav-text">4.3 逆向工程生成po类及mapper(单表CRUD)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-手动定义商品查询mapper"><span class="nav-number">6.4.4.</span> <span class="nav-text">4.4 手动定义商品查询mapper</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-整合service"><span class="nav-number">6.5.</span> <span class="nav-text">5.整合service</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-定义service接口"><span class="nav-number">6.5.1.</span> <span class="nav-text">5.1 定义service接口</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-在Spring容器中配置Service"><span class="nav-number">6.5.2.</span> <span class="nav-text">5.2 在Spring容器中配置Service</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-事务控制—applicationContext-transaction-xml"><span class="nav-number">6.5.3.</span> <span class="nav-text">5.3 事务控制—applicationContext-transaction.xml</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-整合springmvc"><span class="nav-number">6.6.</span> <span class="nav-text">6.整合springmvc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-创建springmvc-xml文件，配置处理器映射器、适配器、视图解析器"><span class="nav-number">6.6.1.</span> <span class="nav-text">6.1 创建springmvc.xml文件，配置处理器映射器、适配器、视图解析器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-配置前端控制器"><span class="nav-number">6.6.2.</span> <span class="nav-text">6.2 配置前端控制器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-3-开发controller"><span class="nav-number">6.6.3.</span> <span class="nav-text">6.3 开发controller</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-4-编写jsp：itemsList-jsp"><span class="nav-number">6.6.4.</span> <span class="nav-text">6.4 编写jsp：itemsList.jsp</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-加载spring容器"><span class="nav-number">6.7.</span> <span class="nav-text">7.加载spring容器</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#七、商品修改功能的开发"><span class="nav-number">7.</span> <span class="nav-text">七、商品修改功能的开发</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-分析："><span class="nav-number">7.1.</span> <span class="nav-text">1.分析：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-开发mapper"><span class="nav-number">7.2.</span> <span class="nav-text">2.开发mapper</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-开发service"><span class="nav-number">7.3.</span> <span class="nav-text">3.开发service</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-开发controller"><span class="nav-number">7.4.</span> <span class="nav-text">4.开发controller</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#八、-RequestMapping"><span class="nav-number">8.</span> <span class="nav-text">八、@RequestMapping</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-URL路径映射："><span class="nav-number">8.1.</span> <span class="nav-text">1.URL路径映射：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-窄化请求映射："><span class="nav-number">8.2.</span> <span class="nav-text">2.窄化请求映射：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-限制请求方法："><span class="nav-number">8.3.</span> <span class="nav-text">3.限制请求方法：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#九、Controller方法的返回值："><span class="nav-number">9.</span> <span class="nav-text">九、Controller方法的返回值：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-返回ModelAndView"><span class="nav-number">9.1.</span> <span class="nav-text">1.返回ModelAndView:</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-返回String："><span class="nav-number">9.2.</span> <span class="nav-text">2.返回String：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-逻辑视图名"><span class="nav-number">9.2.1.</span> <span class="nav-text">2.1 逻辑视图名:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Redirect重定向"><span class="nav-number">9.2.2.</span> <span class="nav-text">2.2  Redirect重定向:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-forward转发"><span class="nav-number">9.2.3.</span> <span class="nav-text">2.3 forward转发:</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-返回void："><span class="nav-number">9.3.</span> <span class="nav-text">3.返回void：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-使用request转向页面："><span class="nav-number">9.3.1.</span> <span class="nav-text">3.1 使用request转向页面：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-通过response页面重定向："><span class="nav-number">9.3.2.</span> <span class="nav-text">3.2 通过response页面重定向：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-通过response指定响应结果，例如响应json数据如下："><span class="nav-number">9.3.3.</span> <span class="nav-text">3.3 通过response指定响应结果，例如响应json数据如下：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十、参数绑定："><span class="nav-number">10.</span> <span class="nav-text">十、参数绑定：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-默认支持的参数类型"><span class="nav-number">10.1.</span> <span class="nav-text">1.  默认支持的参数类型</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-HttpServletRequest"><span class="nav-number">10.1.1.</span> <span class="nav-text">1.1  HttpServletRequest</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-HttpServletResponse"><span class="nav-number">10.1.2.</span> <span class="nav-text">1.2 HttpServletResponse</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-HttpSession"><span class="nav-number">10.1.3.</span> <span class="nav-text">1.3 HttpSession</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-Model-ModelMap"><span class="nav-number">10.1.4.</span> <span class="nav-text">1.4 Model/ModelMap</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-参数绑定介绍"><span class="nav-number">10.2.</span> <span class="nav-text">2. 参数绑定介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-简单类型："><span class="nav-number">10.2.1.</span> <span class="nav-text">2.1 简单类型：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-pojo类型："><span class="nav-number">10.2.2.</span> <span class="nav-text">2.2 pojo类型：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-自定义参数绑定："><span class="nav-number">10.2.3.</span> <span class="nav-text">2.3 自定义参数绑定：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-集合类型："><span class="nav-number">10.2.4.</span> <span class="nav-text">2.4 集合类型：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十一、校验："><span class="nav-number">11.</span> <span class="nav-text">十一、校验：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-校验说明："><span class="nav-number">11.1.</span> <span class="nav-text">1.校验说明：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-SpringMVC校验："><span class="nav-number">11.2.</span> <span class="nav-text">2.SpringMVC校验：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-需求："><span class="nav-number">11.2.1.</span> <span class="nav-text">2.1 需求：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-加入相关的jar包："><span class="nav-number">11.2.2.</span> <span class="nav-text">2.2 加入相关的jar包：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-配置validator"><span class="nav-number">11.2.3.</span> <span class="nav-text">2.3 配置validator:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-将validator加到处理器适配器"><span class="nav-number">11.2.4.</span> <span class="nav-text">2.4 将validator加到处理器适配器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-5-添加校验规则："><span class="nav-number">11.2.5.</span> <span class="nav-text">2.5 添加校验规则：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-6-错误消息文件CustomValidationMessages-properties"><span class="nav-number">11.2.6.</span> <span class="nav-text">2.6 错误消息文件CustomValidationMessages.properties</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-7-捕获错误："><span class="nav-number">11.2.7.</span> <span class="nav-text">2.7 捕获错误：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-8-分组校验："><span class="nav-number">11.2.8.</span> <span class="nav-text">2.8 分组校验：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-9-校验注解："><span class="nav-number">11.2.9.</span> <span class="nav-text">2.9 校验注解：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十二、数据回显："><span class="nav-number">12.</span> <span class="nav-text">十二、数据回显：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-需求："><span class="nav-number">12.1.</span> <span class="nav-text">1.需求：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-简单数据类型："><span class="nav-number">12.2.</span> <span class="nav-text">2. 简单数据类型：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-pojo类型："><span class="nav-number">12.3.</span> <span class="nav-text">3.pojo类型：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-ModelAttribute作用"><span class="nav-number">12.4.</span> <span class="nav-text">4.@ModelAttribute作用</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十三、异常处理器"><span class="nav-number">13.</span> <span class="nav-text">十三、异常处理器</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-异常处理思路："><span class="nav-number">13.1.</span> <span class="nav-text">1.异常处理思路：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-自定义异常类："><span class="nav-number">13.2.</span> <span class="nav-text">2.自定义异常类：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1自定义异常类："><span class="nav-number">13.2.1.</span> <span class="nav-text">2.1自定义异常类：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2自定义异常处理类："><span class="nav-number">13.2.2.</span> <span class="nav-text">2.2自定义异常处理类：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-将异常处理类添加到spring容器："><span class="nav-number">13.3.</span> <span class="nav-text">3.将异常处理类添加到spring容器：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Controller方法抛出异常："><span class="nav-number">13.4.</span> <span class="nav-text">4.Controller方法抛出异常：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-异常显示页面："><span class="nav-number">13.5.</span> <span class="nav-text">5.异常显示页面：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十四、图片上传"><span class="nav-number">14.</span> <span class="nav-text">十四、图片上传</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-需求"><span class="nav-number">14.1.</span> <span class="nav-text">1.需求</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-配置虚拟路径："><span class="nav-number">14.2.</span> <span class="nav-text">2.配置虚拟路径：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-Tomcat配置："><span class="nav-number">14.2.1.</span> <span class="nav-text">2.1 Tomcat配置：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Eclipse配置："><span class="nav-number">14.2.2.</span> <span class="nav-text">2.2 Eclipse配置：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-配置springmvc对多部件类型的解析"><span class="nav-number">14.3.</span> <span class="nav-text">2.配置springmvc对多部件类型的解析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-相关的Jar包"><span class="nav-number">14.4.</span> <span class="nav-text">3.相关的Jar包</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-图片上传："><span class="nav-number">14.5.</span> <span class="nav-text">4.图片上传：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十五、Json数据交互："><span class="nav-number">15.</span> <span class="nav-text">十五、Json数据交互：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-注解说明："><span class="nav-number">15.1.</span> <span class="nav-text">1.注解说明：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-RequestBody："><span class="nav-number">15.1.1.</span> <span class="nav-text">1.1  @RequestBody：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-ResponseBody"><span class="nav-number">15.1.2.</span> <span class="nav-text">1.2  @ResponseBody</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-准备环境："><span class="nav-number">15.2.</span> <span class="nav-text">2.准备环境：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-添加相关的Jar包："><span class="nav-number">15.2.1.</span> <span class="nav-text">2.1 添加相关的Jar包：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-springmvc配置："><span class="nav-number">15.2.2.</span> <span class="nav-text">2.2 springmvc配置：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-请求json响应json："><span class="nav-number">15.3.</span> <span class="nav-text">3.请求json响应json：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-请求key-value响应json："><span class="nav-number">15.4.</span> <span class="nav-text">4.请求key/value响应json：</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十六、RESTful支持"><span class="nav-number">16.</span> <span class="nav-text">十六、RESTful支持</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-什么是RESTful"><span class="nav-number">16.1.</span> <span class="nav-text">1.什么是RESTful</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-对Url进行规范，写RESTful格式的Url"><span class="nav-number">16.1.1.</span> <span class="nav-text">1.1 对Url进行规范，写RESTful格式的Url</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-对http的方法规范"><span class="nav-number">16.1.2.</span> <span class="nav-text">1.2 对http的方法规范</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-对http的contentType规范"><span class="nav-number">16.1.3.</span> <span class="nav-text">1.3 对http的contentType规范</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-使用示例："><span class="nav-number">16.2.</span> <span class="nav-text">2.使用示例：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-需求：-1"><span class="nav-number">16.2.1.</span> <span class="nav-text">2.1 需求：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-Controller方法："><span class="nav-number">16.2.2.</span> <span class="nav-text">2.2 Controller方法：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-前端控制器配置："><span class="nav-number">16.2.3.</span> <span class="nav-text">2.3 前端控制器配置：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-4-静态资源解析："><span class="nav-number">16.2.4.</span> <span class="nav-text">2.4 静态资源解析：</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#十七、拦截器："><span class="nav-number">17.</span> <span class="nav-text">十七、拦截器：</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-定义："><span class="nav-number">17.1.</span> <span class="nav-text">1.定义：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-拦截器实现："><span class="nav-number">17.2.</span> <span class="nav-text">2.拦截器实现：</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-拦截器配置："><span class="nav-number">17.3.</span> <span class="nav-text">3.拦截器配置：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-针对某种mapping配置拦截器"><span class="nav-number">17.3.1.</span> <span class="nav-text">3.1 针对某种mapping配置拦截器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-针对所有mapping配置全局拦截器"><span class="nav-number">17.3.2.</span> <span class="nav-text">3.2 针对所有mapping配置全局拦截器</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-拦截流程测试："><span class="nav-number">17.4.</span> <span class="nav-text">4.拦截流程测试：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-正常流程测试："><span class="nav-number">17.4.1.</span> <span class="nav-text">4.1 正常流程测试：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-中断流程测试："><span class="nav-number">17.4.2.</span> <span class="nav-text">4.2 中断流程测试：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-拦截器应用："><span class="nav-number">17.5.</span> <span class="nav-text">5.拦截器应用：</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-需求："><span class="nav-number">17.5.1.</span> <span class="nav-text">5.1 需求：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-登录Controller实现："><span class="nav-number">17.5.2.</span> <span class="nav-text">5.2 登录Controller实现：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-登录认证拦截实现："><span class="nav-number">17.5.3.</span> <span class="nav-text">5.3 登录认证拦截实现：</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-项目整体代码"><span class="nav-number">17.6.</span> <span class="nav-text">6.项目整体代码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#附录一：MyBatis逆向工程："><span class="nav-number">18.</span> <span class="nav-text">附录一：MyBatis逆向工程：</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#附录二：请求乱码问题："><span class="nav-number">19.</span> <span class="nav-text">附录二：请求乱码问题：</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright" >
  
  &copy;  2016 - 
  <span itemprop="copyrightYear">2017</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Timer</span>
</div>


<div class="powered-by">
  由 <a class="theme-link" href="https://hexo.io">Hexo</a> 强力驱动
</div>

<div class="theme-info">
  主题 -
  <a class="theme-link" href="https://github.com/iissnan/hexo-theme-next">
    NexT.Pisces
  </a>
</div>


        

        
      </div>
    </footer>

    <div class="back-to-top">
      <i class="fa fa-arrow-up"></i>
    </div>
  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  



  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.0"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.0"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.0"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.0"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.0"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.0"></script>



  

  
    
  

  <script type="text/javascript">
    var duoshuoQuery = {short_name:"timerchen"};
    (function() {
      var ds = document.createElement('script');
      ds.type = 'text/javascript';ds.async = true;
      ds.id = 'duoshuo-script';
      ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
      ds.charset = 'UTF-8';
      (document.getElementsByTagName('head')[0]
      || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
  </script>

  
    
      
      <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
      <script src="/js/src/hook-duoshuo.js?v=5.1.0"></script>
    
    
    <script src="/lib/ua-parser-js/dist/ua-parser.min.js?v=0.7.9"></script>
    <script src="/js/src/hook-duoshuo.js"></script>
  








  
  

  

  

  
  <script src="https://cdn1.lncld.net/static/js/av-core-mini-0.6.1.js"></script>
  <script>AV.initialize("SNK7gVWOKWg8kVTixCIiPJOM-gzGzoHsz", "K6sxKbcSnrBPj9W1lWIImVT9");</script>
  <script>
    function showTime(Counter) {
      var query = new AV.Query(Counter);
      var entries = [];
      var $visitors = $(".leancloud_visitors");

      $visitors.each(function () {
        entries.push( $(this).attr("id").trim() );
      });

      query.containedIn('url', entries);
      query.find()
        .done(function (results) {
          var COUNT_CONTAINER_REF = '.leancloud-visitors-count';

          if (results.length === 0) {
            $visitors.find(COUNT_CONTAINER_REF).text(0);
            return;
          }

          for (var i = 0; i < results.length; i++) {
            var item = results[i];
            var url = item.get('url');
            var time = item.get('time');
            var element = document.getElementById(url);

            $(element).find(COUNT_CONTAINER_REF).text(time);
          }
          for(var i = 0; i < entries.length; i++) {
            var url = entries[i];
            var element = document.getElementById(url);
            var countSpan = $(element).find(COUNT_CONTAINER_REF);
            if( countSpan.text() == '') {
              countSpan.text(0);
            }
          }
        })
        .fail(function (object, error) {
          console.log("Error: " + error.code + " " + error.message);
        });
    }

    function addCount(Counter) {
      var $visitors = $(".leancloud_visitors");
      var url = $visitors.attr('id').trim();
      var title = $visitors.attr('data-flag-title').trim();
      var query = new AV.Query(Counter);

      query.equalTo("url", url);
      query.find({
        success: function(results) {
          if (results.length > 0) {
            var counter = results[0];
            counter.fetchWhenSave(true);
            counter.increment("time");
            counter.save(null, {
              success: function(counter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(counter.get('time'));
              },
              error: function(counter, error) {
                console.log('Failed to save Visitor num, with error message: ' + error.message);
              }
            });
          } else {
            var newcounter = new Counter();
            /* Set ACL */
            var acl = new AV.ACL();
            acl.setPublicReadAccess(true);
            acl.setPublicWriteAccess(true);
            newcounter.setACL(acl);
            /* End Set ACL */
            newcounter.set("title", title);
            newcounter.set("url", url);
            newcounter.set("time", 1);
            newcounter.save(null, {
              success: function(newcounter) {
                var $element = $(document.getElementById(url));
                $element.find('.leancloud-visitors-count').text(newcounter.get('time'));
              },
              error: function(newcounter, error) {
                console.log('Failed to create');
              }
            });
          }
        },
        error: function(error) {
          console.log('Error:' + error.code + " " + error.message);
        }
      });
    }

    $(function() {
      var Counter = AV.Object.extend("Counter");
      if ($('.leancloud_visitors').length == 1) {
        addCount(Counter);
      } else if ($('.post-title-link').length > 1) {
        showTime(Counter);
      }
    });
  </script>



  

  


</body>
</html>
